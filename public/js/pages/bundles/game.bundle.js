(()=>{"use strict";var e,t;!function(e){e[e.inProgress=0]="inProgress",e[e.gameFinished=1]="gameFinished"}(e||(e={}));class n{constructor(e,t){this.name=e,this.color=t,this.score=0,this.capturedPieces=0,this.numOfPieces=12,this.numOfKings=0,this.capturesAvailable=!1}updateCapturedPieces(e){this.capturedPieces+=e}updateScore(e){this.score+=e}deepCopyPlayer(){let e=new n(this.name,this.color);return e.numOfPieces=this.numOfPieces,e.numOfKings=this.numOfKings,e}}!function(e){e.Black="black",e.Red="red"}(t||(t={}));class i{constructor(e,t=!1,n=!1){this.color=e,this.isKing=t,this.captureStatus=!1}makeKing(){this.isKing=!0}captureCheck(){this.captureStatus=!0}deepCopyPiece(){return new i(this.color,this.isKing)}}class s{constructor(e,t,n,i){this.startRow=e,this.startCol=t,this.endRow=n,this.endCol=i}equals(e){return this.startRow===e.startRow&&this.startCol===e.startCol&&this.endRow===e.endRow&&this.endCol===e.endCol}}class o{constructor(){this.board=[],this.initializeBoard()}initializeBoard(){for(let e=0;e<8;e++){this.board[e]=[];for(let n=0;n<8;n++)this.board[e][n]=e<3&&(e+n)%2==1?new i(t.Black):e>4&&(e+n)%2==1?new i(t.Red):null}}getPiece(e,t){return this.board[e][t]}}class r{constructor(t,n,i){this.board=(new o).board,this.players=[t,n],this.currentState=e.inProgress,this.currentPlayer=t,this.winner=null,this.numOfTurns=0,this.playerOneMoves=[],this.playerTwoMoves=[],this.forcedJumps=i,this.chainingRow=null,this.chainingCol=null}changeTurn(){this.currentPlayer=this.currentPlayer===this.players[0]?this.players[1]:this.players[0],this.numOfTurns++,this.forcedJumps&&(this.capturesPossible()?this.currentPlayer.capturesAvailable=!0:this.currentPlayer.capturesAvailable=!1)}getPiece(e,t){return this.board[e][t]}validateMove(e,n,i,s){if(i<0||i>=8||s<0||s>=8)return!1;const o=this.getPiece(i,s),r=this.getPiece(e,n);if((null==r?void 0:r.color)===t.Black&&!1===r.isKing)return this.validateBlack(e,n,i,s,o);if((null==r?void 0:r.color)===t.Red&&!1===r.isKing)return this.validateRed(e,n,i,s,o);if(!0===(null==r?void 0:r.isKing)){if(1===Math.abs(e-i)&&1===Math.abs(n-s))return null===o;if(2==Math.abs(e-i)&&2==Math.abs(n-s))return this.canCapture(e,n,i,s)}return!1}validateBlack(e,t,n,i,s){return n-e==1&&1===Math.abs(t-i)?null===s:n-e==2&&2===Math.abs(t-i)&&this.canCapture(e,t,n,i)}validateRed(e,t,n,i,s){return n-e==-1&&1===Math.abs(t-i)?null===s:n-e==-2&&2===Math.abs(t-i)&&this.canCapture(e,t,n,i)}possibleMoves(e,n){const i=this.getPiece(e,n),o=[];if(null!==i){const r=i.color===t.Black?1:-1,l=e,a=n;if(!1===i.isKing){const e=[{endRow:l+r,endCol:a-1},{endRow:l+r,endCol:a+1},{endRow:l+2*r,endCol:a-2},{endRow:l+2*r,endCol:a+2}];for(const t of e)this.validateMove(l,a,t.endRow,t.endCol)&&o.push(new s(l,a,t.endRow,t.endCol))}else{const t=e,i=n,r=[{endRow:t+1,endCol:i-1},{endRow:t+1,endCol:i+1},{endRow:t-1,endCol:i-1},{endRow:t-1,endCol:i+1},{endRow:t+2,endCol:i-2},{endRow:t+2,endCol:i+2},{endRow:t-2,endCol:i-2},{endRow:t-2,endCol:i+2}];for(const e of r)this.validateMove(t,i,e.endRow,e.endCol)&&o.push(new s(t,i,e.endRow,e.endCol))}}return null!==this.chainingRow&&null!==this.chainingCol?e!==this.chainingRow||n!==this.chainingCol?[]:o.filter((e=>2===Math.abs(e.startRow-e.endRow))):this.forcedJumps&&this.currentPlayer.capturesAvailable?o.filter((e=>this.canCapture(e.startRow,e.startCol,e.endRow,e.endCol))):o}canCapture(e,t,n,i){if(2==Math.abs(e-n)&&2==Math.abs(t-i)){const s=(e+n)/2,o=(t+i)/2,r=this.getPiece(s,o),l=this.getPiece(e,t);if(null!==l&&null!==r&&r.color!==l.color&&null===this.getPiece(n,i))return!0}return!1}movePiece(e,t,n,i){const o=this.getPiece(e,t);let r=!1;if(o&&o.color===this.currentPlayer.color&&this.validateMove(e,t,n,i)){if(null!==o){const s=Math.floor((e+n)/2),o=Math.floor((t+i)/2),l=this.getPiece(s,o);this.canCapture(e,t,n,i)?(this.handlePieceCapture(l),!0===(null==l?void 0:l.isKing)&&(this.currentPlayer===this.players[0]?this.players[1].numOfKings-=1:this.players[0].numOfKings-=1),this.board[s][o]=null,r=!0,this.chainingRow=n,this.chainingCol=i):r=!1}this.board[e][t]=null,this.board[n][i]=o,this.currentPlayer===this.players[0]?this.playerOneMoves.push(new s(e,t,n,i)):this.playerTwoMoves.push(new s(e,t,n,i)),!1===o.isKing&&!0===this.promoteToKing(n,i)&&(o.makeKing(),this.currentPlayer.numOfKings+=1),this.capturesPossible();const l=this.chainCaptures(n,i);if(l&&!0===r){if(l.length>0)return console.log(l),this.chainingRow=n,void(this.chainingCol=i);this.chainingRow=null,this.chainingCol=null,this.changeTurn()}else this.chainingRow=null,this.chainingCol=null,this.changeTurn()}console.log(this.numOfTurns),console.log(`Number of Black Pieces: ${this.players[1].numOfPieces}, Kings: ${this.players[1].numOfKings}`),console.log(`Number of Red Pieces: ${this.players[0].numOfPieces}, Kings: ${this.players[0].numOfKings}`)}handlePieceCapture(e){!0===(null==e?void 0:e.isKing)?(this.currentPlayer.updateScore(2),this.currentPlayer.updateCapturedPieces(1)):(this.currentPlayer.updateScore(1),this.currentPlayer.updateCapturedPieces(1)),this.currentPlayer===this.players[0]?this.players[1].numOfPieces-=1:this.players[0].numOfPieces-=1}promoteToKing(e,n){const i=this.getPiece(e,n);return(null==i?void 0:i.color)==t.Red&&0==e||(null==i?void 0:i.color)==t.Black&&7==e}chainCaptures(e,t){return this.possibleMoves(e,t).filter((e=>2===Math.abs(e.startRow-e.endRow))).map((e=>({endRow:e.endRow,endCol:e.endCol})))}capturesPossible(){let e=!1;for(let t=0;t<8;t++)for(let n=0;n<8;n++){const i=this.getPiece(t,n);i&&i.color===this.currentPlayer.color&&this.possibleMoves(t,n).some((e=>2===Math.abs(e.startRow-e.endRow)))&&(i.captureCheck(),e=!0)}return e}isVulnerable(e,n){const i=this.getPiece(e,n);if(!i)return!1;const s=i.color===t.Black?[[1,-1],[1,1]]:[[-1,-1],[-1,1]];for(let[t,o]of s){const s=e+t,r=n+o,l=s+t,a=r+o;if(this.isValidPosition(s,r)&&this.isValidPosition(l,a)){const e=this.getPiece(s,r),t=this.getPiece(l,a);if(e&&e.color!==i.color&&!t)return!0}}return!1}isValidPosition(e,t){return e>=0&&e<8&&t>=0&&t<8}noPiecesLeft(e){return 0===e.numOfPieces}noValidMoves(){let e=0;for(let t=0;t<8;t++)for(let n=0;n<8;n++){const i=this.getPiece(t,n);i&&i.color===this.currentPlayer.color&&this.possibleMoves(t,n).length>0&&e++}return 0===e}checkEndOfGame(){this.noPiecesLeft(this.players[0])&&this.players[1].numOfPieces>=1?(this.currentState=e.gameFinished,this.winner=this.players[1]):this.noPiecesLeft(this.players[1])&&this.players[0].numOfPieces>=1?(this.currentState=e.gameFinished,this.winner=this.players[0]):this.noValidMoves()?(this.currentState=e.gameFinished,this.players[0].score>this.players[1].score?this.winner=this.players[0]:this.players[0].score<this.players[1].score?this.winner=this.players[1]:this.winner=null):this.currentState=e.inProgress}setAI(e){this.players[1]=e}simulateMove(e,t,n,i){const s=this.getPiece(e,t);let o=[],r=!1,l=e,a=t,c=n,h=i;if(s&&this.validateMove(e,t,n,i)){let e=!0;for(;e;)if(this.canCapture(l,a,c,h)){const t=Math.floor((l+c)/2),n=Math.floor((a+h)/2),i=this.getPiece(t,n);if(i){o.push({piece:i,row:t,col:n}),this.board[t][n]=null,this.board[l][a]=null,this.board[c][h]=s,!1===s.isKing&&!0===this.promoteToKing(c,h)&&(s.makeKing(),r=!0),l=c,a=h;const u=this.chainCaptures(c,h);e=u.length>0,e&&(c=u[0].endRow,h=u[0].endCol)}}else this.board[l][a]=null,this.board[c][h]=s,l=c,a=h,!1===s.isKing&&!0===this.promoteToKing(c,h)&&(s.makeKing(),r=!0),e=!1}return[o,r,l,a]}moveAI(e,t,n,i){const s=this.getPiece(e,t);let o=!1;if(s&&s.color===this.currentPlayer.color&&this.validateMove(e,t,n,i)){if(null!==s){const s=Math.floor((e+n)/2),r=Math.floor((t+i)/2);this.canCapture(e,t,n,i)?(this.currentPlayer===this.players[0]?this.players[1].numOfPieces-=1:this.players[0].numOfPieces-=1,this.board[s][r]=null,o=!0):o=!1}this.board[e][t]=null,this.board[n][i]=s,!0===this.promoteToKing(n,i)&&s.makeKing();const r=this.chainCaptures(n,i);if(r&&!0===o){if(r.length>0)return;this.changeTurn()}else this.changeTurn()}}undoSimulation(e,t,n,i,s,o){const r=this.getPiece(n,i);this.board[n][i]=null,this.board[e][t]=r,s.forEach((e=>{this.board[e.row][e.col]=e.piece})),o&&r&&(r.isKing=!1)}deepCopyGame(){const e=new r(this.players[0].deepCopyPlayer(),this.players[1].deepCopyPlayer(),this.forcedJumps);return e.board=this.board.map((e=>e.map((e=>e?e.deepCopyPiece():null)))),e.currentPlayer=this.currentPlayer,e.currentState=this.currentState,e.winner=this.winner?this.winner.deepCopyPlayer():null,e}}class l extends n{constructor(e,t,n,i){super(e,t),this.game=n,this.depth=i,this.openings=this.openingSet(),this.currentOpening=null}heuristic(e){let n=0,i=0,s=0;n+=15*e.players[1].numOfPieces-15*e.players[0].numOfPieces,n-=this.countOpponentCapturesPossible(t.Red,e);for(let o=0;o<8;o++)for(let r=0;r<8;r++){let l=e.getPiece(o,r);if(l){if(l.color===t.Black&&!0===l.isKing?i++:l.color===t.Red&&!0===l.isKing&&s++,r>=2&&r<=5&&o>=3&&o<=4&&(n+=l.color===t.Black?2.5:-2.5),o>=3&&o<=4&&r<2&&r>5&&(n+=l.color===t.Black?.5:-.5),e.numOfTurns<10&&(l.color===t.Black&&0===o?1!==r&&5!==r||(n+=10):l.color===t.Red&&7===o&&(2!==r&&6!==r||(n-=10))),o>=1&&o<=6&&r>=1&&r<=6){let i=l.color===t.Black?o-1:o+1,s=e.getPiece(i,r-1),a=e.getPiece(i,r+1);s&&s.color===l.color&&(n+=l.color===t.Black?6:-6),a&&a.color===l.color&&(n+=l.color===t.Black?6:-6)}e.numOfTurns<15&&l.color===t.Black&&(0===o&&(1!==r&&3!==r&&5!=r||(n+=5)),1===o&&(2!==r&&4!==r||(n+=5)),2===o&&3===r&&(n+=5)),e.isVulnerable(o,r)||(n+=l.color===t.Black?-6:6)}}return n+=20*i-20*s,n}countOpponentCapturesPossible(e,t){let n=0;for(let i=0;i<8;i++)for(let s=0;s<8;s++){const o=t.getPiece(i,s);o&&o.color===e&&(n+=t.possibleMoves(i,s).filter((e=>2===Math.abs(e.startRow-e.endRow))).length)}return n}openingSet(){const e=new Map;return e.set("Old Fourteenth",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(7,0,6,1)]),e.set("Alma",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(7,2,6,1)]),e.set("Centre",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(4,3,3,4)]),e.set("Glasgow",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(5,2,4,1)]),e.set("Laird and Lady",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(5,6,4,7),new s(3,6,4,5),new s(5,4,3,6),new s(2,7,4,5)]),e.set("Black Doctor",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(5,6,4,7),new s(3,6,4,5),new s(5,4,3,6),new s(3,2,5,4),new s(6,3,4,5)]),e.set("Laird and Lady Refused",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(5,6,4,7),new s(1,6,2,5)]),e.set("Glasgow-Whilter",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,6),new s(5,6,4,5),new s(1,6,2,5),new s(5,2,4,1),new s(1,4,2,3)]),e.set("Nailor",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(1,4,2,3)]),e.set("Tillicoultry",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(2,5,3,4)]),e.set("Will o' the Wisp",[new s(5,2,4,3),new s(2,3,3,2),new s(5,6,4,7)]),e.set("Defiance",[new s(5,2,4,3),new s(2,3,3,2),new s(5,6,4,5),new s(1,2,2,3)]),e.set("Fife",[new s(5,2,4,3),new s(2,3,3,2),new s(5,6,4,5),new s(2,5,3,6),new s(6,7,5,6)]),e.set("Souter",[new s(5,2,4,3),new s(2,3,3,2),new s(5,6,4,5),new s(2,5,3,6),new s(6,5,5,6)]),e.set("Whilter-I",[new s(5,2,4,3),new s(2,3,3,2),new s(5,6,4,5),new s(2,5,3,6),new s(6,3,5,2)]),e.set("Whilter-II",[new s(5,2,4,3),new s(2,3,3,2),new s(6,3,5,2)]),e.set("Whilter-Exchange",[new s(5,2,4,3),new s(2,3,3,2),new s(6,3,5,2),new s(2,5,3,4)]),e.set("Maid of the Mill",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(3,6,4,7),new s(4,3,3,4)]),e.set("Douglas",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(3,6,4,7),new s(7,0,6,1),new s(1,6,2,5)]),e.set("Pioneer",[new s(5,2,4,3),new s(2,3,3,2),new s(6,1,5,2),new s(1,6,2,5)]),e.set("White Dyke",[new s(5,2,4,3),new s(2,5,3,6),new s(6,1,5,2),new s(3,6,4,5)]),e.set("Wagram",[new s(5,2,4,3),new s(2,5,3,6),new s(5,6,4,7),new s(2,1,3,0)]),e.set("Boston",[new s(5,2,4,3),new s(2,5,3,6),new s(5,6,4,7),new s(3,6,4,5)]),e.set("Dyke",[new s(5,2,4,3),new s(2,5,3,6),new s(4,3,3,2)]),e.set("Cross",[new s(5,2,4,3),new s(2,3,3,4)]),e.set("Waterloo",[new s(5,2,4,3),new s(2,3,3,4),new s(6,1,5,2),new s(3,4,4,5)]),e.set("Ayrshire Lassie",[new s(5,2,4,3),new s(2,1,3,0),new s(6,1,5,2),new s(1,0,2,1)]),e.set("Switcher",[new s(5,2,4,3),new s(2,7,3,6)]),e.set("Single Corner",[new s(5,2,4,3),new s(2,5,3,4)]),e.set("Second Double Corner",[new s(5,2,4,3),new s(2,1,3,2)]),e.set("Bristol",[new s(5,2,4,1),new s(2,1,3,0),new s(4,1,3,2)]),e.set("Paisley",[new s(5,2,4,1),new s(2,1,3,2)]),e.set("Bristol-Cross",[new s(5,2,4,1),new s(2,3,3,4)]),e}identifyOpening(){let e=!1;if(this.game.numOfTurns<Math.max(...Array.from(this.openings.values()).map((e=>e.length))))for(const[t,n]of this.openings)if(this.game.playerOneMoves.length<=n.length/2&&this.game.playerOneMoves.every(((e,t)=>n[2*t].equals(e)))){this.currentOpening=t,e=!0;break}e||(this.currentOpening=null)}minimax(n,i,s,o,r){if(n.checkEndOfGame(),0==i||n.currentState===e.gameFinished)return[this.heuristic(n),null];let l=r?-1/0:1/0,a=null;if(r){for(let e=0;e<8;e++)for(let r=0;r<8;r++){const c=n.getPiece(e,r);if(c&&c.color===t.Black){const t=n.possibleMoves(e,r);for(const e of t){const t=n.deepCopyGame();t.moveAI(e.startRow,e.startCol,e.endRow,e.endCol);const[r]=this.minimax(t,i-1,s,o,!1);if(o<=(s=Math.max(s,r))){a=e,l=r;break}r>l&&(l=r,a=e)}}}return[l,a]}for(let e=0;e<8;e++)for(let r=0;r<8;r++){const c=n.getPiece(e,r);if(c&&c.color===t.Red){const t=n.possibleMoves(e,r);for(const e of t){const t=n.deepCopyGame();t.moveAI(e.startRow,e.startCol,e.endRow,e.endCol);const[r]=this.minimax(t,i-1,s,o,!0);if((o=Math.min(o,r))<=s){a=e,l=r;break}r<l&&(l=r,a=e)}}}return[l,a]}makeMove(){if(this.game.currentState===e.gameFinished)console.log("Game is finished. AI cannot make a move."),this.game.changeTurn();else if(this.identifyOpening(),this.currentOpening){const e=this.getOpeningMove();e?this.game.movePiece(e.startRow,e.startCol,e.endRow,e.endCol):this.playMinimaxMove()}else 1===this.game.numOfTurns&&null===this.game.getPiece(3,4)?this.game.movePiece(2,5,3,4):3===this.game.numOfTurns&&null===this.game.getPiece(2,5)?this.game.movePiece(1,6,2,5):5===this.game.numOfTurns&&null===this.game.getPiece(1,6)?this.game.movePiece(0,7,1,6):this.playMinimaxMove()}playMinimaxMove(){const[e,t]=this.minimax(this.game,this.depth,-1/0,1/0,!0);t?(this.game.movePiece(null==t?void 0:t.startRow,null==t?void 0:t.startCol,null==t?void 0:t.endRow,null==t?void 0:t.endCol),console.log(`AI moved from: (${null==t?void 0:t.startRow}, ${null==t?void 0:t.startCol}) to (${null==t?void 0:t.endRow}, ${null==t?void 0:t.endCol})`),console.log(`Evaluated Score of move: ${e}`)):(console.log(`${this.game.players[1].name} has no valid moves!`),this.game.changeTurn())}getOpeningMove(){if(this.currentOpening){const e=this.openings.get(this.currentOpening);if(e&&this.game.numOfTurns<e.length)return e[this.game.numOfTurns]}return null}}const a=new Map;let c;const h=document.querySelector(".initial-screen .initial-screen-container .container .name-entry #startGameButton");null==h||h.addEventListener("click",$);const u=document.querySelector(".initial-screen .initial-screen-container .container .name-entry #startAIGameButton");let d;null==u||u.addEventListener("click",L);const w=document.querySelector(".initial-screen .initial-screen-container .container .name-entry #enforcedJumps");null==w||w.addEventListener("change",(e=>{e.target.checked?(d=!0,console.log(`Jumps: ${d}`)):(d=!1,console.log(`Jumps: ${d}`))}));const m=document.getElementById("restartLocalGameButton"),p=document.getElementById("restartAIGameButton"),g=document.querySelector(".end-of-game-section"),y=document.getElementById("winnerAnnouncement"),f=document.getElementById("playerOneFinalName"),C=document.getElementById("playerOneFinalScore"),P=document.getElementById("playerOneFinalCaptured"),v=document.getElementById("playerTwoFinalName"),b=document.getElementById("playerTwoFinalScore"),R=document.getElementById("playerTwoFinalCaptured"),k=document.querySelector(".player-one .container .name"),M=document.querySelector(".player-one .container .score"),O=document.querySelector(".player-one .container .captured"),S=document.querySelector(".player-one .container .turn"),B=document.querySelector(".player-two .container .name"),E=document.querySelector(".player-two .container .score"),x=document.querySelector(".player-two .container .captured"),K=document.querySelector(".player-two .container .turn"),T=document.querySelectorAll(".board-container .container .row");function $(){const e=document.getElementById("playerOneName").value||"Player 1",i=document.getElementById("playerTwoName").value||"Player 2",s=new n(e,t.Red),o=new n(i,t.Black);c=new r(s,o,d),F(),document.querySelector(".initial-screen").style.display="none",document.querySelector(".main").style.display="block",q()}function L(){const e=document.getElementById("playerOneName").value||"Player 1",i="Minimax-A/B",s=new n(e,t.Red),o=new n(i,t.Black);c=new r(s,o,d);const a=new l(i,t.Black,c,5);c.setAI(a),F(),document.querySelector(".initial-screen").style.display="none",document.querySelector(".main").style.display="block",q()}function q(){F(),T.forEach(((e,n)=>{e.querySelectorAll(".col").forEach(((e,i)=>{const s=c.getPiece(n,i);if(s){const o=document.createElement("div");!0===s.isKing?o.classList.add(s.color===t.Black?"black-piece-king":"red-piece-king"):o.classList.add(s.color===t.Black?"black-piece":"red-piece"),e.appendChild(o),o.addEventListener("click",I.bind(null,n,i,o))}}))}))}function A(){document.querySelectorAll(".highlight").forEach((e=>{const t=e;t.classList.remove("highlight");const n=a.get(t);n&&(t.removeEventListener("click",n),a.delete(t))}))}function I(e,t,n){const i=c.getPiece(e,t);if(A(),document.querySelectorAll(".black-piece, .red-piece").forEach((e=>{e.classList.remove("selected")})),document.querySelectorAll(".black-piece-king, .red-piece-king").forEach((e=>{e.classList.remove("selected")})),i&&i.color===c.currentPlayer.color){n.classList.toggle("selected");const i=c.possibleMoves(e,t);i.length>0&&i.forEach((n=>{const i=document.querySelector(`.col[data-row='${n.endRow}'][data-col='${n.endCol}']`);if(i){i.classList.add("highlight");const s=a.get(i);s&&i.removeEventListener("click",s);const o=()=>{!function(e,t,n,i){const s=c.getPiece(e,t);if(s&&s.color===c.currentPlayer.color){if(c.movePiece(e,t,n,i),G(),c.players[1]instanceof l)for(;c.currentPlayer===c.players[1];)c.players[1].makeMove(),G();const o=c.getPiece(n,i);!c.getPiece(e,t)&&o&&console.log(`${s.color} piece has moved from (${e}, ${t}) to (${n}, ${i})`)}}(e,t,n.endRow,n.endCol)};i.addEventListener("click",o),a.set(i,o)}}))}}function F(){k.textContent=`${c.players[0].name}`,M.textContent=`Score: ${c.players[0].score}`,O.textContent=`Captured Pieces: ${c.players[0].capturedPieces}`,B.textContent=`${c.players[1].name}`,E.textContent=`Score: ${c.players[1].score}`,x.textContent=`Captured Pieces: ${c.players[1].capturedPieces}`,c.currentPlayer===c.players[0]?(S.textContent="Turn: Yes",K.textContent="Turn: No"):(S.textContent="Turn: No",K.textContent="Turn: Yes"),c.checkEndOfGame(),c.currentState===e.gameFinished&&(c.winner===c.players[0]?(k.textContent=`${c.players[0].name} has won the game!`,B.textContent=`${c.players[1].name}, you lost, homie!`):c.winner===c.players[1]?(k.textContent=`${c.players[0].name}, you lost, homie!`,B.textContent=`${c.players[1].name} has won the game!`):(k.textContent="Game is a draw!",B.textContent="Game is a draw!"),S.textContent="",K.textContent="",g.style.display="flex",y.textContent=c.winner?`Winner: ${c.winner.name}`:"It's a draw!",f.textContent=c.players[0].name,C.textContent=`Score: ${c.players[0].score}`,P.textContent=`Captured Pieces: ${c.players[0].capturedPieces}`,v.textContent=c.players[1].name,b.textContent=`Score: ${c.players[1].score}`,R.textContent=`Captured Pieces: ${c.players[1].capturedPieces}`)}function G(){A(),T.forEach((e=>{e.querySelectorAll(".col").forEach((e=>{if(e.firstChild){const t=e.firstChild,n=a.get(t);n&&(t.removeEventListener("click",n),a.delete(t)),e.removeChild(e.firstChild)}}))})),q()}m.addEventListener("click",(()=>{g.style.display="none",A(),T.forEach((e=>{e.querySelectorAll(".col").forEach((e=>{if(e.firstChild){const t=e.firstChild,n=a.get(t);n&&(t.removeEventListener("click",n),a.delete(t)),e.removeChild(e.firstChild)}}))})),$()})),p.addEventListener("click",(()=>{g.style.display="none",A(),T.forEach((e=>{e.querySelectorAll(".col").forEach((e=>{if(e.firstChild){const t=e.firstChild,n=a.get(t);n&&(t.removeEventListener("click",n),a.delete(t)),e.removeChild(e.firstChild)}}))})),L()}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEtBRXZCc0csRUFBU1ksSUFBSSx5QkFBMEIsQ0FDbkMsSUFBSWxILEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEtBRXZCc0csRUFBU1ksSUFBSSxrQkFBbUIsQ0FDNUIsSUFBSWxILEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksU0FBVSxDQUNuQixJQUFJbEgsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksZUFBZ0IsQ0FDekIsSUFBSWxILEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcs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QSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksU0FBVSxDQUNuQixJQUFJbEgsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksU0FBVSxDQUNuQixJQUFJbEgsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksT0FBUSxDQUNqQixJQUFJbEgsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsS0FFdkJzRyxFQUFTWSxJQUFJLFFBQVMsQ0FDbEIsSUFBSWxILEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksV0FBWSxDQUNyQixJQUFJbEgsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxLQUV2QnNHLEVBQVNZLElBQUksa0JBQW1CLENBQzVCLElBQUlsSCxFQUFNLEVBQUcsRUFBRyxFQUFHLEdBQ25CLElBQUlBLEVBQU0sRUFBRyxFQUFHLEVBQUcsR0FDbkIsSUFBSUEsRUFBTSxFQUFHLEVBQUcsRUFBRyxHQUNuQixJQUFJQSxFQUFNLEVBQUcs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QUlnTSxXQUNmTCxFQUFtQjNELEVBQW9CRCxJQUFJMkMsR0FDN0NpQixJQUNBakIsRUFBU1ksb0JBQW9CLFFBQVNLLEdBQ3RDM0QsRUFBb0J1RCxPQUFPYixJQUUvQjFLLEVBQUlpTSxZQUFZak0sRUFBSWdNLFdBQ3hCLElBQ0YsSUFHTjFCLEdBQ0osQ0FyUEF6QixFQUF1QlQsaUJBQWlCLFNBQVMsS0FDN0NZLEVBQWlCb0IsTUFBTUMsUUFBVSxPQUNqQ1ksSUFFQWpCLEVBQUs1RSxTQUFTckYsSUFDVkEsRUFBSWtLLGlCQUFpQixRQUFRN0UsU0FBU3BGLElBRWxDLEdBQUlBLEVBQUlnTSxXQUFZLENBQ2hCLE1BQU10QixFQUFXMUssRUFBSWdNLFdBQ2ZMLEVBQW1CM0QsRUFBb0JELElBQUkyQyxHQUM3Q2lCLElBQ0FqQixFQUFTWSxvQkFBb0IsUUFBU0ssR0FDdEMzRCxFQUFvQnVELE9BQU9iLElBRS9CMUssRUFBSWlNLFlBQVlqTSxFQUFJZ00sV0FDeEIsSUFDRixJQUVOM0QsR0FBZ0IsSUFNcEJVLEVBQW9CWCxpQkFBaUIsU0FBUyxLQUMxQ1ksRUFBaUJvQixNQUFNQyxRQUFVLE9BQ2pDWSxJQUVBakIsRUFBSzVFLFNBQVNyRixJQUNWQSxFQUFJa0ssaUJBQWlCLFFBQVE3RSxTQUFTcEYsSUFFbEMsR0FBSUEsRUFBSWdNLFdBQVksQ0FDaEIsTUFBTXRCLEVBQVcxSyxFQUFJZ00sV0FDZkwsRUFBbUIzRCxFQUFvQkQsSUFBSTJDLEdBQzdDaUIsSUFDQWpCLEVBQVNZLG9CQUFvQixRQUFTSyxHQUN0QzNELEVBQW9CdUQsT0FBT2IsSUFFL0IxSyxFQUFJaU0sWUFBWWpNLEVBQUlnTSxXQUN4QixJQUNGLElBRU54RCxHQUFhLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvY2hlY2tlcnNHYW1lLnRzIiwid2VicGFjazovL3Byb2plY3QvLi9zcmMvY29tcG9uZW50cy9jaGVja2Vyc0FJLnRzIiwid2VicGFjazovL3Byb2plY3QvLi9zcmMvcGFnZXMvY2hlY2tlcnMtZG9tLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoZWNrZXJzQUkgfSBmcm9tIFwiLi9jaGVja2Vyc0FJXCI7XHJcblxyXG4vKipcclxuICogRW51bSByZXByZXNlbnRpbmcgdGhlIHN0YXRlIG9mIHRoZSBjaGVja2VycyBnYW1lLlxyXG4gKi9cclxuZXhwb3J0IGVudW0gU3RhdGUge1xyXG4gICAgaW5Qcm9ncmVzcyxcclxuICAgIGdhbWVGaW5pc2hlZFxyXG59XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIHBsYXllciBpbiB0aGUgY2hlY2tlcnMgZ2FtZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBQbGF5ZXIge1xyXG4gICAgcHVibGljIG5hbWU6IHN0cmluZztcclxuICAgIHB1YmxpYyBjb2xvcjogUGllY2VDb2xvcjtcclxuICAgIHB1YmxpYyBzY29yZTogbnVtYmVyO1xyXG4gICAgcHVibGljIGNhcHR1cmVkUGllY2VzOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgbnVtT2ZQaWVjZXM6IG51bWJlcjtcclxuICAgIHB1YmxpYyBudW1PZktpbmdzOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgY2FwdHVyZXNBdmFpbGFibGU6IGJvb2xlYW47XHJcblxyXG4gICAgIC8qKlxyXG4gICAgICogQ29uc3RydWN0cyBhIFBsYXllciBvYmplY3QuXHJcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBwbGF5ZXIuXHJcbiAgICAgKiBAcGFyYW0ge1BpZWNlQ29sb3J9IGNvbG9yIC0gVGhlIGNvbG9yIGFzc2lnbmVkIHRvIHRoZSBwbGF5ZXIuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgY29sb3I6IFBpZWNlQ29sb3IpIHtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuY29sb3IgPSBjb2xvcjtcclxuICAgICAgICB0aGlzLnNjb3JlID0gMDtcclxuICAgICAgICB0aGlzLmNhcHR1cmVkUGllY2VzID0gMDtcclxuICAgICAgICB0aGlzLm51bU9mUGllY2VzID0gMTI7XHJcbiAgICAgICAgdGhpcy5udW1PZktpbmdzID0gMDtcclxuICAgICAgICB0aGlzLmNhcHR1cmVzQXZhaWxhYmxlID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBVcGRhdGVzIHRoZSBudW1iZXIgb2YgcGllY2VzIGNhcHR1cmVkIGJ5IHRoZSBwbGF5ZXIuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY291bnQgLSBUaGUgbnVtYmVyIG9mIHBpZWNlcyBjYXB0dXJlZCBpbiBhIG1vdmUuXHJcbiAgICAgKi9cclxuICAgIHVwZGF0ZUNhcHR1cmVkUGllY2VzKGNvdW50OiBudW1iZXIpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmNhcHR1cmVkUGllY2VzICs9IGNvdW50O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVXBkYXRlcyB0aGUgc2NvcmUgb2YgdGhlIHBsYXllci5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzY29yZSAtIFRoZSBzY29yZSB0byBiZSBhZGRlZCB0byB0aGUgcGxheWVyJ3MgY3VycmVudCBzY29yZS5cclxuICAgICAqL1xyXG4gICAgdXBkYXRlU2NvcmUoc2NvcmU6IG51bWJlcik6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuc2NvcmUgKz0gc2NvcmU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXRob2QgdG8gY3JlYXRlIGEgY29weSBvZiB0aGUgUGxheWVyIGluc3RhbmNlIHRvIGJlIHVzZWQgaW4gbWluaW1heCBhbGdvcml0aG1cclxuICAgICAqIEByZXR1cm5zIHtQbGF5ZXJ9IC0gY29weSBvZiB0aGUgcGxheWVyIGluc3RhbmNlXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBkZWVwQ29weVBsYXllcigpOiBQbGF5ZXIge1xyXG4gICAgICAgIGxldCBjb3BpZWRQbGF5ZXIgPSBuZXcgUGxheWVyKHRoaXMubmFtZSwgdGhpcy5jb2xvcik7XHJcbiAgICAgICAgY29waWVkUGxheWVyLm51bU9mUGllY2VzID0gdGhpcy5udW1PZlBpZWNlcztcclxuICAgICAgICBjb3BpZWRQbGF5ZXIubnVtT2ZLaW5ncyA9IHRoaXMubnVtT2ZLaW5nc1xyXG5cclxuICAgICAgICByZXR1cm4gY29waWVkUGxheWVyO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW51bSBmb3IgcGllY2UgY29sb3JzIGluIHRoZSBjaGVja2VycyBnYW1lLlxyXG4gKi9cclxuZXhwb3J0IGVudW0gUGllY2VDb2xvciB7XHJcbiAgICBCbGFjayA9ICdibGFjaycsXHJcbiAgICBSZWQgPSAncmVkJ1xyXG59XHJcblxyXG4vKipcclxuICogUmVwcmVzZW50cyBhIGNoZWNrZXJzIHBpZWNlLCBpbmNsdWRpbmcgaXRzIGNvbG9yIGFuZCBraW5nIHN0YXR1cy5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBDaGVja2Vyc1BpZWNlIHtcclxuICAgIHB1YmxpYyBjb2xvcjogUGllY2VDb2xvcjtcclxuICAgIHB1YmxpYyBpc0tpbmc6IGJvb2xlYW47XHJcbiAgICBwdWJsaWMgY2FwdHVyZVN0YXR1czogYm9vbGVhbjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgYSBDaGVja2Vyc1BpZWNlIG9iamVjdC5cclxuICAgICAqIEBwYXJhbSB7UGllY2VDb2xvcn0gY29sb3IgLSBUaGUgY29sb3Igb2YgdGhlIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtib29sZWFufSBpc0tpbmcgLSBJbmRpY2F0ZXMgaWYgdGhlIHBpZWNlIGlzIGEga2luZy4gRGVmYXVsdCBpcyBmYWxzZS5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoY29sb3I6IFBpZWNlQ29sb3IsIGlzS2luZzpib29sZWFuID0gZmFsc2UsIGNhcHR1cmVTdGF0dXM6IGJvb2xlYW4gPSBmYWxzZSl7XHJcbiAgICAgICAgdGhpcy5jb2xvciA9IGNvbG9yO1xyXG4gICAgICAgIHRoaXMuaXNLaW5nID0gaXNLaW5nO1xyXG4gICAgICAgIHRoaXMuY2FwdHVyZVN0YXR1cyA9IGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogUHJvbW90ZXMgdGhlIHBpZWNlIHRvIGEga2luZy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIG1ha2VLaW5nKCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuaXNLaW5nID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2FwdHVyZUNoZWNrKCkge1xyXG4gICAgICAgIHRoaXMuY2FwdHVyZVN0YXR1cyA9IHRydWU7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgY29weSBvZiB0aGUgQ2hlY2tlcnNQaWVjZSBpbnN0YW5jZVxyXG4gICAgICogQHJldHVybnMge0NoZWNrZXJzUGllY2V9IC0gY29weSBvZiB0aGUgY2hlY2tlcnMgcGllY2VcclxuICAgICAqL1xyXG4gICAgcHVibGljIGRlZXBDb3B5UGllY2UoKTogQ2hlY2tlcnNQaWVjZSB7XHJcbiAgICAgICAgY29uc3QgY29waWVkUGllY2UgPSBuZXcgQ2hlY2tlcnNQaWVjZSh0aGlzLmNvbG9yLCB0aGlzLmlzS2luZyk7XHJcbiAgICAgICAgcmV0dXJuIGNvcGllZFBpZWNlO1xyXG4gICAgfVxyXG5cclxufVxyXG5cclxuLyoqXHJcbiAqIENsYXNzIHRvIHN0b3JlIHRoZSBzdGFydCBhbmQgZW5kIHBvc2l0aW9ucyBvZiBhIG1vdmUgaW4gYSBjaGVja2VycyBnYW1lLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIE1vdmVzIHtcclxuICAgIHB1YmxpYyBzdGFydFJvdzogbnVtYmVyO1xyXG4gICAgcHVibGljIHN0YXJ0Q29sOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgZW5kUm93OiBudW1iZXI7XHJcbiAgICBwdWJsaWMgZW5kQ29sOiBudW1iZXI7XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIGEgTW92ZXMgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0Um93IC0gVGhlIHN0YXJ0aW5nIHJvdyBvZiB0aGUgbW92ZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydENvbCAtIFRoZSBzdGFydGluZyBjb2x1bW4gb2YgdGhlIG1vdmUuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kUm93IC0gVGhlIGVuZGluZyByb3cgb2YgdGhlIG1vdmUuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gZW5kQ29sIC0gVGhlIGVuZGluZyBjb2x1bW4gb2YgdGhlIG1vdmUuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sOiBudW1iZXIsIGVuZFJvdzogbnVtYmVyLCBlbmRDb2w6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuc3RhcnRSb3cgPSBzdGFydFJvdztcclxuICAgICAgICB0aGlzLnN0YXJ0Q29sID0gc3RhcnRDb2w7XHJcbiAgICAgICAgdGhpcy5lbmRSb3cgPSBlbmRSb3c7XHJcbiAgICAgICAgdGhpcy5lbmRDb2wgPSBlbmRDb2w7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGVxdWFscyhjaGVja01vdmU6IE1vdmVzKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RhcnRSb3cgPT09IGNoZWNrTW92ZS5zdGFydFJvdyAmJiB0aGlzLnN0YXJ0Q29sID09PSBjaGVja01vdmUuc3RhcnRDb2wgJiZcclxuICAgICAgICAgICAgICAgdGhpcy5lbmRSb3cgPT09IGNoZWNrTW92ZS5lbmRSb3cgJiYgdGhpcy5lbmRDb2wgPT09IGNoZWNrTW92ZS5lbmRDb2w7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBNYW5hZ2VzIHRoZSBzdGF0ZSBhbmQgaW5pdGlhbGl6YXRpb24gb2YgdGhlIGNoZWNrZXJzIGJvYXJkLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENoZWNrZXJzQm9hcmQge1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXByZXNlbnRzIHRoZSBjaGVja2VycyBib2FyZCBhcyBhIDJEIGFycmF5LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYm9hcmQ6IChDaGVja2Vyc1BpZWNlIHwgbnVsbClbXVtdID0gW107XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb25zdHJ1Y3RzIGEgQ2hlY2tlcnNCb2FyZCBvYmplY3QgYW5kIGluaXRpYWxpemVzIHRoZSBib2FyZC5cclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IoKXtcclxuICAgICAgICB0aGlzLmluaXRpYWxpemVCb2FyZCgpO1xyXG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuYm9hcmQpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2V0cyB0aGUgYm9hcmQgdG8gaXRzIHN0YXJ0aW5nIHN0YXRlIHdpdGggcGllY2VzIHBvc2l0aW9uZWQuXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgaW5pdGlhbGl6ZUJvYXJkKCk6IHZvaWQge1xyXG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDg7IHJvdysrKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYm9hcmRbcm93XSA9IFtdO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJvdyA8IDMgJiYgKHJvdyArIGNvbCkgJSAyID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtyb3ddW2NvbF0gPSBuZXcgQ2hlY2tlcnNQaWVjZShQaWVjZUNvbG9yLkJsYWNrKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJvdyA+IDQgJiYgKHJvdyArIGNvbCkgJSAyID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtyb3ddW2NvbF0gPSBuZXcgQ2hlY2tlcnNQaWVjZShQaWVjZUNvbG9yLlJlZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3Jvd11bY29sXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZXRyaWV2ZXMgdGhlIHBpZWNlIGF0IHRoZSBzcGVjaWZpZWQgcG9zaXRpb24gb24gdGhlIGJvYXJkLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdyAtIFRoZSByb3cgb2YgdGhlIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbCAtIFRoZSBjb2x1bW4gb2YgdGhlIHBpZWNlLlxyXG4gICAgICogQHJldHVybnMge0NoZWNrZXJzUGllY2UgfCBudWxsfSAtIFRoZSBwaWVjZSBhdCB0aGUgc3BlY2lmaWVkIHBvc2l0aW9uIG9yIG51bGwgaWYgZW1wdHkuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnZXRQaWVjZShyb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiBDaGVja2Vyc1BpZWNlIHwgbnVsbCB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuYm9hcmRbcm93XVtjb2xdO1xyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogTWFuYWdlcyB0aGUgb3ZlcmFsbCBnYW1lIHN0YXRlIG9mIGEgY2hlY2tlcnMgZ2FtZSwgaW5jbHVkaW5nIHRoZSBib2FyZCwgcGxheWVycywgdHVybnMsIGFuZCBnYW1lIHByb2dyZXNzLlxyXG4gKi9cclxuZXhwb3J0IGNsYXNzIENoZWNrZXJzR2FtZSB7XHJcbiAgICBwdWJsaWMgYm9hcmQ6IChDaGVja2Vyc1BpZWNlIHwgbnVsbCkgW11bXTtcclxuICAgIHB1YmxpYyBwbGF5ZXJzOiBbUGxheWVyLCBQbGF5ZXJdO1xyXG4gICAgcHVibGljIGN1cnJlbnRTdGF0ZTogU3RhdGU7XHJcbiAgICBwdWJsaWMgY3VycmVudFBsYXllcjogUGxheWVyO1xyXG4gICAgcHVibGljIHdpbm5lcjogUGxheWVyIHwgbnVsbDtcclxuICAgIHB1YmxpYyBudW1PZlR1cm5zOiBudW1iZXI7XHJcbiAgICBwdWJsaWMgcGxheWVyT25lTW92ZXM6IE1vdmVzIFtdO1xyXG4gICAgcHVibGljIHBsYXllclR3b01vdmVzOiBNb3ZlcyBbXTtcclxuICAgIHB1YmxpYyBmb3JjZWRKdW1wczogYm9vbGVhbjtcclxuICAgIHB1YmxpYyBjaGFpbmluZ1JvdzogbnVtYmVyIHwgbnVsbDtcclxuICAgIHB1YmxpYyBjaGFpbmluZ0NvbDogbnVtYmVyIHwgbnVsbDtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENvbnN0cnVjdHMgYSBDaGVja2Vyc0dhbWUgb2JqZWN0LlxyXG4gICAgICogQHBhcmFtIHtQbGF5ZXJ9IHBsYXllck9uZSAtIFRoZSBmaXJzdCBwbGF5ZXIuXHJcbiAgICAgKiBAcGFyYW0ge1BsYXllcn0gcGxheWVyVHdvIC0gVGhlIHNlY29uZCBwbGF5ZXIuXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKHBsYXllck9uZTogUGxheWVyLCBwbGF5ZXJUd286IFBsYXllciwgZm9yY2VkSnVtcHM6IGJvb2xlYW4pIHtcclxuICAgICAgICB0aGlzLmJvYXJkID0gbmV3IENoZWNrZXJzQm9hcmQoKS5ib2FyZDtcclxuICAgICAgICB0aGlzLnBsYXllcnMgPSBbcGxheWVyT25lLCBwbGF5ZXJUd29dO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFN0YXRlID0gU3RhdGUuaW5Qcm9ncmVzcztcclxuICAgICAgICB0aGlzLmN1cnJlbnRQbGF5ZXIgPSBwbGF5ZXJPbmU7XHJcbiAgICAgICAgdGhpcy53aW5uZXIgPSBudWxsO1xyXG4gICAgICAgIHRoaXMubnVtT2ZUdXJucyA9IDA7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJPbmVNb3ZlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMucGxheWVyVHdvTW92ZXMgPSBbXTtcclxuICAgICAgICB0aGlzLmZvcmNlZEp1bXBzID0gZm9yY2VkSnVtcHM7XHJcbiAgICAgICAgdGhpcy5jaGFpbmluZ1JvdyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5jaGFpbmluZ0NvbCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGFuZ2VzIHRoZSB0dXJuIHRvIHRoZSBuZXh0IHBsYXllci5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGNoYW5nZVR1cm4oKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50UGxheWVyID0gdGhpcy5jdXJyZW50UGxheWVyID09PSB0aGlzLnBsYXllcnNbMF0gPyB0aGlzLnBsYXllcnNbMV06IHRoaXMucGxheWVyc1swXTtcclxuICAgICAgICB0aGlzLm51bU9mVHVybnMrKztcclxuICAgICAgICBpZiAodGhpcy5mb3JjZWRKdW1wcykge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jYXB0dXJlc1Bvc3NpYmxlKCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXllci5jYXB0dXJlc0F2YWlsYWJsZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRQbGF5ZXIuY2FwdHVyZXNBdmFpbGFibGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJldHJpZXZlcyB0aGUgcGllY2UgYXQgdGhlIHNwZWNpZmllZCBib2FyZCBjb29yZGluYXRlcy5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3cgLSBUaGUgcm93IG9mIHRoZSBwaWVjZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2wgLSBUaGUgY29sdW1uIG9mIHRoZSBwaWVjZS5cclxuICAgICAqIEByZXR1cm5zIHtDaGVja2Vyc1BpZWNlIHwgbnVsbH0gLSBUaGUgcGllY2UgYXQgdGhlIGdpdmVuIHBvc2l0aW9uLCBvciBudWxsIGlmIGVtcHR5LlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0UGllY2Uocm93OiBudW1iZXIsIGNvbDogbnVtYmVyKTogQ2hlY2tlcnNQaWVjZSB8IG51bGwge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmJvYXJkW3Jvd11bY29sXTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFZhbGlkYXRlcyBhIHByb3Bvc2VkIG1vdmUgZm9yIGEgcGllY2UuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRSb3cgLSBUaGUgc3RhcnRpbmcgcm93IG9mIHRoZSBtb3ZlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0Q29sIC0gVGhlIHN0YXJ0aW5nIGNvbHVtbiBvZiB0aGUgbW92ZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmRSb3cgLSBUaGUgZW5kaW5nIHJvdyBvZiB0aGUgbW92ZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBlbmRDb2wgLSBUaGUgZW5kaW5nIGNvbHVtbiBvZiB0aGUgbW92ZS5cclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlIG1vdmUgaXMgdmFsaWQsIGZhbHNlIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIHZhbGlkYXRlTW92ZShzdGFydFJvdzogbnVtYmVyLCBzdGFydENvbDogbnVtYmVyLCBlbmRSb3c6IG51bWJlciwgZW5kQ29sOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgICAgICAvLyBjaGVjayB0byBzZWUgaWYgYXR0ZW1wdGVkIG1vdmUgd2lsbCBwbGFjZSBwaWVjZSBvdXRzaWRlIGJvYXJkXHJcbiAgICAgICAgaWYgKGVuZFJvdyA8IDAgfHwgZW5kUm93ID49IDggfHwgZW5kQ29sIDwgMCB8fCBlbmRDb2wgPj0gOCkge1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGRlc3RpbmF0aW9uU3F1YXJlID0gdGhpcy5nZXRQaWVjZShlbmRSb3csIGVuZENvbCk7XHJcbiAgICAgICAgY29uc3QgcGllY2UgPSB0aGlzLmdldFBpZWNlKHN0YXJ0Um93LCBzdGFydENvbCk7XHJcblxyXG4gICAgICAgIGlmIChwaWVjZT8uY29sb3IgPT09IFBpZWNlQ29sb3IuQmxhY2sgJiYgcGllY2UuaXNLaW5nID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAvLyB2YWxpZGF0ZSBtb3ZlIGZvciB0aGUgQmxhY2sgcGllY2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGVCbGFjayhzdGFydFJvdywgc3RhcnRDb2wsIGVuZFJvdywgZW5kQ29sLCBkZXN0aW5hdGlvblNxdWFyZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHBpZWNlPy5jb2xvciA9PT0gUGllY2VDb2xvci5SZWQgJiYgcGllY2UuaXNLaW5nID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAvLyB2YWxpZGF0ZSBtb3ZlIGZvciB0aGUgcmVkIHBpZWNlXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbGlkYXRlUmVkKHN0YXJ0Um93LCBzdGFydENvbCwgZW5kUm93LCBlbmRDb2wsIGRlc3RpbmF0aW9uU3F1YXJlKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChwaWVjZT8uaXNLaW5nID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIGlmIChNYXRoLmFicyhzdGFydFJvdyAtIGVuZFJvdykgPT09IDEgJiYgTWF0aC5hYnMoc3RhcnRDb2wgLSBlbmRDb2wpID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZGVzdGluYXRpb25TcXVhcmUgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgZWxzZSBpZiAoTWF0aC5hYnMoc3RhcnRSb3cgLSBlbmRSb3cpID09IDIgJiYgTWF0aC5hYnMoc3RhcnRDb2wgLSBlbmRDb2wpID09IDIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmNhbkNhcHR1cmUoc3RhcnRSb3csIHN0YXJ0Q29sLCBlbmRSb3csIGVuZENvbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBtZXRob2Qgb2YgdmFsaWRhdGlvbiBmb3IgYmxhY2sgcGllY2VzXHJcbiAgICBwdWJsaWMgdmFsaWRhdGVCbGFjayhzdGFydFJvdzogbnVtYmVyLCBzdGFydENvbDogbnVtYmVyLCBlbmRSb3c6IG51bWJlciwgZW5kQ29sOiBudW1iZXIsIGRlc3RpbmF0aW9uU3F1YXJlOiBDaGVja2Vyc1BpZWNlIHwgbnVsbCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChlbmRSb3cgLSBzdGFydFJvdyA9PT0gMSAmJiBNYXRoLmFicyhzdGFydENvbCAtIGVuZENvbCkgPT09IDEpIHtcclxuICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uU3F1YXJlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGVuZFJvdyAtIHN0YXJ0Um93ID09PSAyICYmIE1hdGguYWJzKHN0YXJ0Q29sIC0gZW5kQ29sKSA9PT0gMikge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jYW5DYXB0dXJlKHN0YXJ0Um93LCBzdGFydENvbCwgZW5kUm93LCBlbmRDb2wpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBtZXRob2Qgb2YgdmFsaWRhdGlvbiBmb3IgcmVkIHBpZWNlc1xyXG4gICAgcHVibGljIHZhbGlkYXRlUmVkKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sOiBudW1iZXIsIGVuZFJvdzogbnVtYmVyLCBlbmRDb2w6IG51bWJlciwgZGVzdGluYXRpb25TcXVhcmU6IENoZWNrZXJzUGllY2UgfCBudWxsKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKGVuZFJvdyAtIHN0YXJ0Um93ID09PSAtMSAmJiBNYXRoLmFicyhzdGFydENvbCAtIGVuZENvbCkgPT09IDEpIHtcclxuICAgICAgICAgICAgaWYgKGRlc3RpbmF0aW9uU3F1YXJlICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKGVuZFJvdyAtIHN0YXJ0Um93ID09PSAtMiAmJiBNYXRoLmFicyhzdGFydENvbCAtIGVuZENvbCkgPT09IDIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2FuQ2FwdHVyZShzdGFydFJvdywgc3RhcnRDb2wsIGVuZFJvdywgZW5kQ29sKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDb21wdXRlcyB0aGUgcG9zc2libGUgbW92ZXMgZm9yIGEgcGllY2UgYXQgYSBnaXZlbiBib2FyZCBwb3NpdGlvbi5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3cgLSBUaGUgcm93IG9mIHRoZSBwaWVjZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2wgLSBUaGUgY29sdW1uIG9mIHRoZSBwaWVjZS5cclxuICAgICAqIEByZXR1cm5zIHtNb3Zlc1tdfSAtIEFuIGFycmF5IG9mIHBvc3NpYmxlIG1vdmVzIGZvciB0aGUgcGllY2UuXHJcbiAgICAgKi8gXHJcbiAgICBwdWJsaWMgcG9zc2libGVNb3Zlcyhyb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiBNb3Zlc1tdIHtcclxuICAgICAgICBjb25zdCBwaWVjZSA9IHRoaXMuZ2V0UGllY2Uocm93LCBjb2wpO1xyXG4gICAgICAgIGNvbnN0IG1vdmVzOiBNb3Zlc1tdID0gW107XHJcblxyXG4gICAgICAgIGlmIChwaWVjZSAhPT0gbnVsbCkge1xyXG4gICAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBwaWVjZS5jb2xvciA9PT0gUGllY2VDb2xvci5CbGFjayA/IDE6IC0xO1xyXG4gICAgICAgICAgICBjb25zdCBzdGFydFJvdyA9IHJvdztcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnRDb2wgPSBjb2w7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBjaGVjayBmb3IgcmVndWxhciBwaWVjZXNcclxuICAgICAgICAgICAgaWYgKHBpZWNlLmlzS2luZyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBvdGVudGlhbE1vdmVzQXJyID0gW1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlZ3VsYXIgbW92ZXNcclxuICAgICAgICAgICAgICAgICAgICB7ZW5kUm93OiBzdGFydFJvdyArIGRpcmVjdGlvbiwgZW5kQ29sOiBzdGFydENvbCAtIDF9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93ICsgZGlyZWN0aW9uLCBlbmRDb2w6IHN0YXJ0Q29sICsgMX0sXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gY2FwdHVyZSBtb3Zlc1xyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93ICsgMiAqIGRpcmVjdGlvbiwgZW5kQ29sOiBzdGFydENvbCAtIDJ9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93ICsgMiAqIGRpcmVjdGlvbiwgZW5kQ29sOiBzdGFydENvbCArIDJ9XHJcbiAgICAgICAgICAgICAgICBdO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbW92ZSBvZiBwb3RlbnRpYWxNb3Zlc0Fycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlTW92ZShzdGFydFJvdywgc3RhcnRDb2wsIG1vdmUuZW5kUm93LCBtb3ZlLmVuZENvbCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW92ZXMucHVzaChuZXcgTW92ZXMoc3RhcnRSb3csIHN0YXJ0Q29sLCBtb3ZlLmVuZFJvdywgbW92ZS5lbmRDb2wpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAvLyBmb3Iga2luZyBwaWVjZXNcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0Um93ID0gcm93O1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RhcnRDb2wgPSBjb2w7XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgcG90ZW50aWFsTW92ZXNBcnIgPSBbXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVndWxhciBtb3Zlc1xyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93ICsgMSwgZW5kQ29sOiBzdGFydENvbCAtIDF9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93ICsgMSwgZW5kQ29sOiBzdGFydENvbCArIDF9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93IC0gMSwgZW5kQ29sOiBzdGFydENvbCAtIDF9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93IC0gMSwgZW5kQ29sOiBzdGFydENvbCArIDF9LFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNhcHR1cmUgbW92ZXNcclxuICAgICAgICAgICAgICAgICAgICB7ZW5kUm93OiBzdGFydFJvdyArIDIgLCBlbmRDb2w6IHN0YXJ0Q29sIC0gMn0sXHJcbiAgICAgICAgICAgICAgICAgICAge2VuZFJvdzogc3RhcnRSb3cgKyAyICwgZW5kQ29sOiBzdGFydENvbCArIDJ9LFxyXG4gICAgICAgICAgICAgICAgICAgIHtlbmRSb3c6IHN0YXJ0Um93IC0gMiAsIGVuZENvbDogc3RhcnRDb2wgLSAyfSxcclxuICAgICAgICAgICAgICAgICAgICB7ZW5kUm93OiBzdGFydFJvdyAtIDIgLCBlbmRDb2w6IHN0YXJ0Q29sICsgMn1cclxuICAgICAgICAgICAgICAgIF07XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1vdmUgb2YgcG90ZW50aWFsTW92ZXNBcnIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52YWxpZGF0ZU1vdmUoc3RhcnRSb3csIHN0YXJ0Q29sLCBtb3ZlLmVuZFJvdywgbW92ZS5lbmRDb2wpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVzLnB1c2gobmV3IE1vdmVzKHN0YXJ0Um93LCBzdGFydENvbCwgbW92ZS5lbmRSb3csIG1vdmUuZW5kQ29sKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEZpbHRlciBtb3ZlcyBmb3IgY2hhaW5pbmdcclxuICAgICAgICBpZiAodGhpcy5jaGFpbmluZ1JvdyAhPT0gbnVsbCAmJiB0aGlzLmNoYWluaW5nQ29sICE9PSBudWxsKSB7XHJcbiAgICAgICAgICAgIGlmIChyb3cgIT09IHRoaXMuY2hhaW5pbmdSb3cgfHwgY29sICE9PSB0aGlzLmNoYWluaW5nQ29sKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBJZiBpdCdzIG5vdCB0aGUgY2hhaW5pbmcgcGllY2UsIGl0IGNhbm5vdCBtb3ZlXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gb25seSBjYXB0dXJlIG1vdmVzIGZvciB0aGUgY2hhaW5pbmcgcGllY2VcclxuICAgICAgICAgICAgICAgIHJldHVybiBtb3Zlcy5maWx0ZXIobW92ZSA9PiBNYXRoLmFicyhtb3ZlLnN0YXJ0Um93IC0gbW92ZS5lbmRSb3cpID09PSAyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBDb25kaXRpb25hbCB0byBlbnN1cmUgZm9yY2VkIGp1bXBzXHJcbiAgICAgICAgaWYgKHRoaXMuZm9yY2VkSnVtcHMpIHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBsYXllci5jYXB0dXJlc0F2YWlsYWJsZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG1vdmVzLmZpbHRlcihtb3ZlID0+IHRoaXMuY2FuQ2FwdHVyZShtb3ZlLnN0YXJ0Um93LCBtb3ZlLnN0YXJ0Q29sLCBtb3ZlLmVuZFJvdywgbW92ZS5lbmRDb2wpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbW92ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgYSBwaWVjZSBjYW4gY2FwdHVyZSBhbiBvcHBvbmVudCdzIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0Um93IC0gVGhlIHN0YXJ0aW5nIHJvdyBvZiB0aGUgY2FwdHVyaW5nIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHN0YXJ0Q29sIC0gVGhlIHN0YXJ0aW5nIGNvbHVtbiBvZiB0aGUgY2FwdHVyaW5nIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZFJvdyAtIFRoZSByb3cgd2hlcmUgdGhlIGNhcHR1cmUgd291bGQgZW5kLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZENvbCAtIFRoZSBjb2x1bW4gd2hlcmUgdGhlIGNhcHR1cmUgd291bGQgZW5kLlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gVHJ1ZSBpZiBhIGNhcHR1cmUgaXMgcG9zc2libGUsIGZhbHNlIG90aGVyd2lzZS5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGNhbkNhcHR1cmUoc3RhcnRSb3c6bnVtYmVyLCBzdGFydENvbDpudW1iZXIsIGVuZFJvdzpudW1iZXIsIGVuZENvbDogbnVtYmVyKTogYm9vbGVhbiB7XHJcbiAgICAgICAgaWYgKE1hdGguYWJzKHN0YXJ0Um93IC0gZW5kUm93KSA9PSAyICYmIE1hdGguYWJzKHN0YXJ0Q29sIC0gZW5kQ29sKSA9PSAyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1pZGRsZVJvdyA9IChzdGFydFJvdyArIGVuZFJvdykgLyAyO1xyXG4gICAgICAgICAgICBjb25zdCBtaWRkbGVDb2wgPSAoc3RhcnRDb2wgKyBlbmRDb2wpIC8gMjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG1pZGRsZVBpZWNlID0gdGhpcy5nZXRQaWVjZShtaWRkbGVSb3csIG1pZGRsZUNvbCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRQaWVjZSA9IHRoaXMuZ2V0UGllY2Uoc3RhcnRSb3csIHN0YXJ0Q29sKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChjdXJyZW50UGllY2UgIT09IG51bGwgJiYgbWlkZGxlUGllY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgIGlmIChtaWRkbGVQaWVjZS5jb2xvciAhPT0gY3VycmVudFBpZWNlLmNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVzdGluYXRpb25TcXVhcmUgPSB0aGlzLmdldFBpZWNlKGVuZFJvdywgZW5kQ29sKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZGVzdGluYXRpb25TcXVhcmUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1vdmVzIGEgcGllY2UgZnJvbSBvbmUgcG9zaXRpb24gdG8gYW5vdGhlciwgaWYgdGhlIG1vdmUgaXMgdmFsaWQuXHJcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc3RhcnRSb3cgLSBUaGUgc3RhcnRpbmcgcm93IG9mIHRoZSBwaWVjZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydENvbCAtIFRoZSBzdGFydGluZyBjb2x1bW4gb2YgdGhlIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZFJvdyAtIFRoZSBlbmRpbmcgcm93IG9mIHRoZSBtb3ZlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGVuZENvbCAtIFRoZSBlbmRpbmcgY29sdW1uIG9mIHRoZSBtb3ZlLlxyXG4gICAgICogSGFuZGxlcyBwaWVjZSBjYXB0dXJlcywgY2hhaW4gY2FwdHVyZXMsIHBpZWNlIHByb21vdGlvbnMgYW5kIGNoYW5nZSBvZiB0dXJucy4gXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtb3ZlUGllY2Uoc3RhcnRSb3c6IG51bWJlciwgc3RhcnRDb2w6IG51bWJlciwgZW5kUm93OiBudW1iZXIsIGVuZENvbDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgcGllY2UgPSB0aGlzLmdldFBpZWNlKHN0YXJ0Um93LCBzdGFydENvbCk7XHJcbiAgICAgICAgbGV0IGNhcHR1cmVkQWxyZWFkeSA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChwaWVjZSAmJiBwaWVjZS5jb2xvciA9PT0gdGhpcy5jdXJyZW50UGxheWVyLmNvbG9yKXtcclxuICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVNb3ZlKHN0YXJ0Um93LCBzdGFydENvbCwgZW5kUm93LCBlbmRDb2wpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGllY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtaWRkbGVSb3cgPSBNYXRoLmZsb29yKChzdGFydFJvdyArIGVuZFJvdykgLyAyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtaWRkbGVDb2wgPSBNYXRoLmZsb29yKChzdGFydENvbCArIGVuZENvbCkgLyAyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBlbmVteVBpZWNlID0gdGhpcy5nZXRQaWVjZShtaWRkbGVSb3csIG1pZGRsZUNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FuQ2FwdHVyZShzdGFydFJvdywgc3RhcnRDb2wsIGVuZFJvdywgZW5kQ29sKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZVBpZWNlQ2FwdHVyZShlbmVteVBpZWNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZW15UGllY2U/LmlzS2luZyA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBsYXllciA9PT0gdGhpcy5wbGF5ZXJzWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJzWzFdLm51bU9mS2luZ3MgLT0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJzWzBdLm51bU9mS2luZ3MgLT0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW21pZGRsZVJvd11bbWlkZGxlQ29sXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcHR1cmVkQWxyZWFkeSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhaW5pbmdSb3cgPSBlbmRSb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhaW5pbmdDb2wgPSBlbmRDb2w7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXB0dXJlZEFscmVhZHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtzdGFydFJvd11bc3RhcnRDb2xdID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbZW5kUm93XVtlbmRDb2xdID0gcGllY2U7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudFBsYXllciA9PT0gdGhpcy5wbGF5ZXJzWzBdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJPbmVNb3Zlcy5wdXNoKG5ldyBNb3ZlcyhzdGFydFJvdywgc3RhcnRDb2wsIGVuZFJvdywgZW5kQ29sKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGxheWVyVHdvTW92ZXMucHVzaChuZXcgTW92ZXMoc3RhcnRSb3csIHN0YXJ0Q29sLCBlbmRSb3csIGVuZENvbCkpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChwaWVjZS5pc0tpbmcgPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucHJvbW90ZVRvS2luZyhlbmRSb3csIGVuZENvbCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGllY2UubWFrZUtpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50UGxheWVyLm51bU9mS2luZ3MgKz0gMTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGhpcy5jYXB0dXJlc1Bvc3NpYmxlKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXh0Q2FwdHVyZXMgPSB0aGlzLmNoYWluQ2FwdHVyZXMoZW5kUm93LCBlbmRDb2wpO1xyXG4gICAgICAgICAgICAgICAgaWYgKG5leHRDYXB0dXJlcyAmJiBjYXB0dXJlZEFscmVhZHkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobmV4dENhcHR1cmVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2cobmV4dENhcHR1cmVzKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFpbmluZ1JvdyA9IGVuZFJvdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFpbmluZ0NvbCA9IGVuZENvbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGFpbmluZ1JvdyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhaW5pbmdDb2wgPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZVR1cm4oKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYWluaW5nUm93ID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYWluaW5nQ29sID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoYW5nZVR1cm4oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zb2xlLmxvZyh0aGlzLm51bU9mVHVybnMpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBOdW1iZXIgb2YgQmxhY2sgUGllY2VzOiAke3RoaXMucGxheWVyc1sxXS5udW1PZlBpZWNlc30sIEtpbmdzOiAke3RoaXMucGxheWVyc1sxXS5udW1PZktpbmdzfWApO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBOdW1iZXIgb2YgUmVkIFBpZWNlczogJHt0aGlzLnBsYXllcnNbMF0ubnVtT2ZQaWVjZXN9LCBLaW5nczogJHt0aGlzLnBsYXllcnNbMF0ubnVtT2ZLaW5nc31gKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEhhbmRsZXMgdGhlIGNhcHR1cmUgb2YgYSBwaWVjZSwgdXBkYXRpbmcgdGhlIGNhcHR1cmluZyBwbGF5ZXIncyBzY29yZSBhbmQgY2FwdHVyZWQgcGllY2VzIGNvdW50LlxyXG4gICAgICogQHBhcmFtIHtDaGVja2Vyc1BpZWNlIHwgbnVsbH0gcGllY2UgLSBUaGUgcGllY2UgYmVpbmcgY2FwdHVyZWQuXHJcbiAgICAgKi8gXHJcbiAgICBwdWJsaWMgaGFuZGxlUGllY2VDYXB0dXJlKHBpZWNlOiBDaGVja2Vyc1BpZWNlIHwgbnVsbCk6IHZvaWQge1xyXG4gICAgICAgIGlmIChwaWVjZT8uaXNLaW5nID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXllci51cGRhdGVTY29yZSgyKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGxheWVyLnVwZGF0ZUNhcHR1cmVkUGllY2VzKDEpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFBsYXllci51cGRhdGVTY29yZSgxKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50UGxheWVyLnVwZGF0ZUNhcHR1cmVkUGllY2VzKDEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50UGxheWVyID09PSB0aGlzLnBsYXllcnNbMF0pIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXJzWzFdLm51bU9mUGllY2VzIC09IDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnBsYXllcnNbMF0ubnVtT2ZQaWVjZXMgLT0gMTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQcm9tb3RlcyBhIHBpZWNlIHRvIGEga2luZyBpZiBpdCByZWFjaGVzIHRoZSBvcHBvc2l0ZSBlbmQgb2YgdGhlIGJvYXJkLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdyAtIFRoZSByb3cgb2YgdGhlIHBpZWNlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGNvbCAtIFRoZSBjb2x1bW4gb2YgdGhlIHBpZWNlLlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gUmV0dXJuIHdoZXRoZXIgb3Igbm90IGEgcGllY2Ugd2FzIHByb21vdGVkXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBwcm9tb3RlVG9LaW5nKHJvdzogbnVtYmVyLCBjb2w6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHBpZWNlID0gdGhpcy5nZXRQaWVjZShyb3csIGNvbCk7XHJcbiAgICAgICAgaWYgKHBpZWNlPy5jb2xvciA9PSBQaWVjZUNvbG9yLlJlZCAmJiByb3cgPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9IFxyXG4gICAgICAgIGVsc2UgaWYgKHBpZWNlPy5jb2xvciA9PSBQaWVjZUNvbG9yLkJsYWNrICYmIHJvdyA9PSA3KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtyZXR1cm4gZmFsc2V9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogRGV0ZXJtaW5lcyBpZiBhIHBpZWNlIGNhbiBtYWtlIGFkZGl0aW9uYWwgY2FwdHVyZXMgYWZ0ZXIgYW4gaW5pdGlhbCBjYXB0dXJlLlxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHJvdyAtIFRoZSByb3cgb2YgdGhlIGNhcHR1cmluZyBwaWVjZS5cclxuICAgICAqIEBwYXJhbSB7bnVtYmVyfSBjb2wgLSBUaGUgY29sdW1uIG9mIHRoZSBjYXB0dXJpbmcgcGllY2UuXHJcbiAgICAgKiBAcmV0dXJucyB7e2VuZFJvdzogbnVtYmVyLCBlbmRDb2w6IG51bWJlcn1bXX0gLSBBbiBhcnJheSBvZiBwb3RlbnRpYWwgY2FwdHVyZSBtb3Zlcy5cclxuICAgICAqL1xyXG4gICAgcHVibGljIGNoYWluQ2FwdHVyZXMocm93OiBudW1iZXIsIGNvbDogbnVtYmVyKSB7XHJcbiAgICAgICAgY29uc3QgbW92ZXMgPSB0aGlzLnBvc3NpYmxlTW92ZXMocm93LCBjb2wpO1xyXG4gICAgICAgIGNvbnN0IGNhcHR1cmVNb3ZlcyA9IG1vdmVzLmZpbHRlcihtb3ZlID0+IE1hdGguYWJzKG1vdmUuc3RhcnRSb3cgLSBtb3ZlLmVuZFJvdykgPT09IDIpO1xyXG4gICAgICAgIHJldHVybiBjYXB0dXJlTW92ZXMubWFwKG1vdmUgPT4gKHtlbmRSb3c6IG1vdmUuZW5kUm93LCBlbmRDb2w6IG1vdmUuZW5kQ29sfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2tzIGlmIHRoZSBjdXJyZW50IHBsYXllciBoYXMgYW55IHBvc3NpYmxlIGNhcHR1cmVzIG9uIHRoZSBib2FyZC5cclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgdGhlcmUgYXJlIHBvc3NpYmxlIGNhcHR1cmVzLCBmYWxzZSBvdGhlcndpc2UuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjYXB0dXJlc1Bvc3NpYmxlKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCBmbGFnID0gZmFsc2U7XHJcbiAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgODsgcm93KyspIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgODsgY29sKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBpZWNlID0gdGhpcy5nZXRQaWVjZShyb3csIGNvbCk7XHJcbiAgICAgICAgICAgICAgICBpZiAocGllY2UgJiYgcGllY2UuY29sb3IgPT09IHRoaXMuY3VycmVudFBsYXllci5jb2xvcil7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW92ZXMgPSB0aGlzLnBvc3NpYmxlTW92ZXMocm93LCBjb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChtb3Zlcy5zb21lKG1vdmUgPT4gTWF0aC5hYnMobW92ZS5zdGFydFJvdyAtIG1vdmUuZW5kUm93KSA9PT0gMikpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGllY2UuY2FwdHVyZUNoZWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZsYWcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmxhZztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaXNWdWxuZXJhYmxlKHJvdzogbnVtYmVyLCBjb2w6IG51bWJlcik6IGJvb2xlYW4ge1xyXG4gICAgICAgIGNvbnN0IHBpZWNlID0gdGhpcy5nZXRQaWVjZShyb3csIGNvbCk7XHJcbiAgICAgICAgaWYgKCFwaWVjZSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgXHJcbiAgICAgICAgLy8gQ2hlY2sgZGlhZ29uYWxseSBpbiBhbGwgZGlyZWN0aW9ucyBmb3Igb3Bwb25lbnQgcGllY2VzXHJcbiAgICAgICAgY29uc3QgZGlyZWN0aW9ucyA9IHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLkJsYWNrID8gW1sxLCAtMV0sIFsxLCAxXV0gOiBbWy0xLCAtMV0sIFstMSwgMV1dO1xyXG4gICAgICAgIGZvciAobGV0IFtkciwgZGNdIG9mIGRpcmVjdGlvbnMpIHtcclxuICAgICAgICAgICAgY29uc3Qgb3Bwb25lbnRSb3cgPSByb3cgKyBkcjtcclxuICAgICAgICAgICAgY29uc3Qgb3Bwb25lbnRDb2wgPSBjb2wgKyBkYztcclxuICAgICAgICAgICAgY29uc3QgbGFuZGluZ1JvdyA9IG9wcG9uZW50Um93ICsgZHI7XHJcbiAgICAgICAgICAgIGNvbnN0IGxhbmRpbmdDb2wgPSBvcHBvbmVudENvbCArIGRjO1xyXG4gICAgXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoZSBvcHBvbmVudCBhbmQgbGFuZGluZyBwb3NpdGlvbnMgYXJlIG9uIHRoZSBib2FyZFxyXG4gICAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkUG9zaXRpb24ob3Bwb25lbnRSb3csIG9wcG9uZW50Q29sKSAmJiB0aGlzLmlzVmFsaWRQb3NpdGlvbihsYW5kaW5nUm93LCBsYW5kaW5nQ29sKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgb3Bwb25lbnRQaWVjZSA9IHRoaXMuZ2V0UGllY2Uob3Bwb25lbnRSb3csIG9wcG9uZW50Q29sKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxhbmRpbmdTcG90ID0gdGhpcy5nZXRQaWVjZShsYW5kaW5nUm93LCBsYW5kaW5nQ29sKTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhlcmUgaXMgYW4gb3Bwb25lbnQgcGllY2UgYW5kIHRoZSBsYW5kaW5nIHNwb3QgYWZ0ZXIgY2FwdHVyZSBpcyBlbXB0eVxyXG4gICAgICAgICAgICAgICAgaWYgKG9wcG9uZW50UGllY2UgJiYgb3Bwb25lbnRQaWVjZS5jb2xvciAhPT0gcGllY2UuY29sb3IgJiYgIWxhbmRpbmdTcG90KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICBwcml2YXRlIGlzVmFsaWRQb3NpdGlvbihyb3c6IG51bWJlciwgY29sOiBudW1iZXIpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gcm93ID49IDAgJiYgcm93IDwgOCAmJiBjb2wgPj0gMCAmJiBjb2wgPCA4O1xyXG4gICAgfSAgICBcclxuXHJcbiAgICAvKipcclxuICAgICAqIERldGVybWluZXMgaWYgYSBwbGF5ZXIgaGFzIHJ1biBvdXQgb2YgcGllY2VzIG9uIHRoZSBib2FyZC5cclxuICAgICAqIEBwYXJhbSB7UGxheWVyfSBwbGF5ZXIgLSBUaGUgcGxheWVyIHRvIGNoZWNrIGZvciByZW1haW5pbmcgcGllY2VzLlxyXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59IC0gVHJ1ZSBpZiB0aGUgcGxheWVyIGhhcyBubyBwaWVjZXMgbGVmdCwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbm9QaWVjZXNMZWZ0KHBsYXllcjogUGxheWVyKSA6IGJvb2xlYW4ge1xyXG4gICAgICAgIGlmIChwbGF5ZXIubnVtT2ZQaWVjZXMgPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBcclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH0gXHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIGN1cnJlbnQgcGxheWVyIGNhbm5vdCBtYWtlIGFueSB2YWxpZCBtb3Zlcy5cclxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSAtIFRydWUgaWYgbm8gdmFsaWQgbW92ZXMgYXJlIGF2YWlsYWJsZSwgZmFsc2Ugb3RoZXJ3aXNlLlxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgbm9WYWxpZE1vdmVzKCk6IGJvb2xlYW4ge1xyXG4gICAgICAgIGxldCB2YWxpZE1vdmVzID0gMDtcclxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCA4OyByb3crKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGllY2UgPSB0aGlzLmdldFBpZWNlKHJvdywgY29sKTtcclxuICAgICAgICAgICAgICAgIGlmIChwaWVjZSAmJiBwaWVjZS5jb2xvciA9PT0gdGhpcy5jdXJyZW50UGxheWVyLmNvbG9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucG9zc2libGVNb3Zlcyhyb3csIGNvbCkubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWxpZE1vdmVzKys7ICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWxpZE1vdmVzID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgaWYgdGhlIGdhbWUgaGFzIGVuZGVkIGFuZCBkZXRlcm1pbmVzIHRoZSB3aW5uZXIuXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBjaGVja0VuZE9mR2FtZSgpOiB2b2lkIHtcclxuICAgICAgICBpZiAodGhpcy5ub1BpZWNlc0xlZnQodGhpcy5wbGF5ZXJzWzBdKSAmJiB0aGlzLnBsYXllcnNbMV0ubnVtT2ZQaWVjZXMgPj0gMSkge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRTdGF0ZSA9IFN0YXRlLmdhbWVGaW5pc2hlZDtcclxuICAgICAgICAgICAgdGhpcy53aW5uZXIgPSB0aGlzLnBsYXllcnNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHRoaXMubm9QaWVjZXNMZWZ0KHRoaXMucGxheWVyc1sxXSkgJiYgdGhpcy5wbGF5ZXJzWzBdLm51bU9mUGllY2VzID49IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhdGUgPSBTdGF0ZS5nYW1lRmluaXNoZWQ7XHJcbiAgICAgICAgICAgIHRoaXMud2lubmVyID0gdGhpcy5wbGF5ZXJzWzBdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aGlzLm5vVmFsaWRNb3ZlcygpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFN0YXRlID0gU3RhdGUuZ2FtZUZpbmlzaGVkO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5wbGF5ZXJzWzBdLnNjb3JlID4gdGhpcy5wbGF5ZXJzWzFdLnNjb3JlKXtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lubmVyID0gdGhpcy5wbGF5ZXJzWzBdXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5wbGF5ZXJzWzBdLnNjb3JlIDwgdGhpcy5wbGF5ZXJzWzFdLnNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLndpbm5lciA9IHRoaXMucGxheWVyc1sxXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMud2lubmVyID0gbnVsbDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U3RhdGUgPSBTdGF0ZS5pblByb2dyZXNzO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBBSSBQbGF5ZXIgU3BlY2lmaWMgTWV0aG9kczpcclxuICAgIC8qKlxyXG4gICAgICogU2V0cyBwbGF5ZXIgMiBhcyB0aGUgQUlcclxuICAgICAqIEBwYXJhbSBhaVBsYXllciAtIFRoZSBBSSBwbGF5ZXJcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNldEFJKGFpUGxheWVyOiBDaGVja2Vyc0FJKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXJzWzFdID0gYWlQbGF5ZXI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUaGUgQUkgcGxheWVyIHVzZXMgdGhpcyBtZXRob2QgdG8gc2ltdWxhdGUgbW92ZXMgb24gdGhlIGJvYXJkXHJcbiAgICAgKiBAcGFyYW0gc3RhcnRSb3cgLSBTdGFydGluZyByb3cgb2YgdGhlIG1vdmluZyBwaWVjZVxyXG4gICAgICogQHBhcmFtIHN0YXJ0Q29sIC0gU3RhcnRpbmcgY29sdW1uIG9mIHRoZSBtb3ZpbmcgcGllY2VcclxuICAgICAqIEBwYXJhbSBlbmRSb3cgLSBFbmRpbmcgcm93IG9mIHRoZSBtb3ZpbmcgcGllY2VcclxuICAgICAqIEBwYXJhbSBlbmRDb2wgLSBFbmRpbmcgY29sdW1uIG9mIHRoZSBtb3ZpbmcgcGllY2VcclxuICAgICAqIEByZXR1cm5zIHtbe3BpZWNlOiBDaGVja2Vyc1BpZWNlLCByb3c6IG51bWJlciwgY29sOiBudW1iZXJ9W10sIGJvb2xlYW4sIG51bWJlciwgbnVtYmVyXX0gLSBSZXR1cm4gYW4gYXJyYXkgY29udGFpbmFpbmcgYW4gYXJyYXkgb2YgdGhlIHBpZWNlcyBjYXB0dXJlZCBhcyB3ZWxsIGFzIFxyXG4gICAgICogdGhlaXIgcG9zaXRpb25zLCBhIGJvb2xlYW4gdHJhY2tpbmcgd2hldGhlciB0aGUgbW92aW5nIHBpZWNlIHdhcyBwcm9tb3RlZCBhbmQgdGhlIGZpbmFsIHJvdyBhbmQgY29sdW1uIG9mIHRoZSBwaWVjZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc2ltdWxhdGVNb3ZlKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sOiBudW1iZXIsIGVuZFJvdzogbnVtYmVyLCBlbmRDb2w6IG51bWJlcik6XHJcbiAgICAgW3twaWVjZTogQ2hlY2tlcnNQaWVjZSwgcm93OiBudW1iZXIsIGNvbDogbnVtYmVyfVtdLCBib29sZWFuLCBudW1iZXIsIG51bWJlcl0ge1xyXG4gICAgICAgIGNvbnN0IHBpZWNlID0gdGhpcy5nZXRQaWVjZShzdGFydFJvdywgc3RhcnRDb2wpO1xyXG4gICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgYWxsIGNhcHR1cmVkIHBpZWNlcyBvciBub25lIGlmIG5vbmUgYXJlIGNhcHR1cmVkXHJcbiAgICAgICAgbGV0IGNhcHR1cmVkUGllY2VzOiB7cGllY2U6IENoZWNrZXJzUGllY2UsIHJvdzogbnVtYmVyLCBjb2w6IG51bWJlcn0gW10gPSBbXTtcclxuICAgICAgICBsZXQgd2FzUHJvbW90ZWQgPSBmYWxzZTtcclxuICAgICAgICBsZXQgY3VycmVudFJvdyA9IHN0YXJ0Um93LCBjdXJyZW50Q29sID0gc3RhcnRDb2w7XHJcbiAgICAgICAgbGV0IG1vdmVSb3cgPSBlbmRSb3csIG1vdmVDb2wgPSBlbmRDb2w7XHJcblxyXG4gICAgICAgIGlmIChwaWVjZSAmJiB0aGlzLnZhbGlkYXRlTW92ZShzdGFydFJvdywgc3RhcnRDb2wsIGVuZFJvdywgZW5kQ29sKSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbGV0IGNhbkNvbnRpbnVlQ2FwdHVyZSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICB3aGlsZSAoY2FuQ29udGludWVDYXB0dXJlKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW5DYXB0dXJlKGN1cnJlbnRSb3csIGN1cnJlbnRDb2wsIG1vdmVSb3csIG1vdmVDb2wpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkZGxlUm93ID0gTWF0aC5mbG9vcigoY3VycmVudFJvdyArIG1vdmVSb3cpIC8gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWlkZGxlQ29sID0gTWF0aC5mbG9vcigoY3VycmVudENvbCArIG1vdmVDb2wpIC8gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FwdHVyZWRQaWVjZSA9IHRoaXMuZ2V0UGllY2UobWlkZGxlUm93LCBtaWRkbGVDb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIHN0b3JlIGNhcHR1cmVkIHBpZWNlcyBpbiB0aGlzIGFycmF5XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNhcHR1cmVkUGllY2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FwdHVyZWRQaWVjZXMucHVzaCh7cGllY2U6IGNhcHR1cmVkUGllY2UsIHJvdzogbWlkZGxlUm93LCBjb2w6IG1pZGRsZUNvbH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW21pZGRsZVJvd11bbWlkZGxlQ29sXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuYm9hcmRbY3VycmVudFJvd11bY3VycmVudENvbF0gPSBudWxsOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFttb3ZlUm93XVttb3ZlQ29sXSA9IHBpZWNlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpZWNlLmlzS2luZyA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb21vdGVUb0tpbmcobW92ZVJvdywgbW92ZUNvbCkgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWVjZS5tYWtlS2luZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdhc1Byb21vdGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIGN1cnJlbnQgcm93IGFuZCBjb2xcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFJvdyA9IG1vdmVSb3c7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDb2wgPSBtb3ZlQ29sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXh0Q2FwdHVyZXMgPSB0aGlzLmNoYWluQ2FwdHVyZXMobW92ZVJvdywgbW92ZUNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbkNvbnRpbnVlQ2FwdHVyZSA9IG5leHRDYXB0dXJlcy5sZW5ndGggPiAwO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhbkNvbnRpbnVlQ2FwdHVyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXNzdW1pbmcgYWkgd2lsbCBjaG9vc2UgZmlyc3QgY2FwdHVyZSBtb3ZlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3ZlUm93ID0gbmV4dENhcHR1cmVzWzBdLmVuZFJvdztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdmVDb2wgPSBuZXh0Q2FwdHVyZXNbMF0uZW5kQ29sO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtjdXJyZW50Um93XVtjdXJyZW50Q29sXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib2FyZFttb3ZlUm93XVttb3ZlQ29sXSA9IHBpZWNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSb3cgPSBtb3ZlUm93O1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDb2wgPSBtb3ZlQ29sO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAocGllY2UuaXNLaW5nID09PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9tb3RlVG9LaW5nKG1vdmVSb3csIG1vdmVDb2wpID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwaWVjZS5tYWtlS2luZygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2FzUHJvbW90ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNhbkNvbnRpbnVlQ2FwdHVyZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9ICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gS2VlcCB0cmFjayBvZiBjYXB0dXJlZFBpZWNlIGlmIHRoZXJlIGlzIG9uZSB0byByZXZlcnNlIGl0IGluIHRoZSBnYW1lIHN0YXRlIGFmdGVyIHRoZSBzaW11bGF0aW9uXHJcbiAgICAgICAgcmV0dXJuIFtjYXB0dXJlZFBpZWNlcywgd2FzUHJvbW90ZWQsIGN1cnJlbnRSb3csIGN1cnJlbnRDb2xdO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGhlIG5ldyAnc2ltdWxhdGVNb3ZlJyBmdW5jdGlvbiBmb3IgdGhlIEFJIHRvIHVzZSwgdG8gc2FmZWx5IG1ha2UgbW92ZXMgb24gdGhlIGJvYXJkIGR1cmluZyBtaW5pbWF4IHdpdGhvdXQgXHJcbiAgICAgKiBpbmNvcnJlY3RseSBhbHRlcmluZyB0aGUgYWN0dWFsIGdhbWUgc3RhdGVcclxuICAgICAqIEBwYXJhbSBzdGFydFJvdyAtIFN0YXJ0aW5nIHJvdyBvZiB0aGUgbW92aW5nIHBpZWNlXHJcbiAgICAgKiBAcGFyYW0gc3RhcnRDb2wgLSBTdGFydGluZyBjb2x1bW4gb2YgdGhlIG1vdmluZyBwaWVjZVxyXG4gICAgICogQHBhcmFtIGVuZFJvdyAtIEVuZGluZyByb3cgb2YgdGhlIG1vdmluZyBwaWVjZVxyXG4gICAgICogQHBhcmFtIGVuZENvbCAtIEVuZGluZyBjb2x1bW4gb2YgdGhlIG1vdmluZyBwaWVjZVxyXG4gICAgICogXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBtb3ZlQUkoc3RhcnRSb3c6IG51bWJlciwgc3RhcnRDb2w6IG51bWJlciwgZW5kUm93OiBudW1iZXIsIGVuZENvbDogbnVtYmVyKTogdm9pZCB7XHJcbiAgICAgICAgY29uc3QgcGllY2UgPSB0aGlzLmdldFBpZWNlKHN0YXJ0Um93LCBzdGFydENvbCk7XHJcbiAgICAgICAgbGV0IGNhcHR1cmVkQWxyZWFkeSA9IGZhbHNlO1xyXG4gICAgICAgIGlmIChwaWVjZSAmJiBwaWVjZS5jb2xvciA9PT0gdGhpcy5jdXJyZW50UGxheWVyLmNvbG9yKXtcclxuICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVNb3ZlKHN0YXJ0Um93LCBzdGFydENvbCwgZW5kUm93LCBlbmRDb2wpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocGllY2UgIT09IG51bGwpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtaWRkbGVSb3cgPSBNYXRoLmZsb29yKChzdGFydFJvdyArIGVuZFJvdykgLyAyKTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtaWRkbGVDb2wgPSBNYXRoLmZsb29yKChzdGFydENvbCArIGVuZENvbCkgLyAyKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jYW5DYXB0dXJlKHN0YXJ0Um93LCBzdGFydENvbCwgZW5kUm93LCBlbmRDb2wpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRQbGF5ZXIgPT09IHRoaXMucGxheWVyc1swXSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXJzWzFdLm51bU9mUGllY2VzIC09IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsYXllcnNbMF0ubnVtT2ZQaWVjZXMgLT0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW21pZGRsZVJvd11bbWlkZGxlQ29sXSA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhcHR1cmVkQWxyZWFkeSA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXB0dXJlZEFscmVhZHkgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLmJvYXJkW3N0YXJ0Um93XVtzdGFydENvbF0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtlbmRSb3ddW2VuZENvbF0gPSBwaWVjZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wcm9tb3RlVG9LaW5nKGVuZFJvdywgZW5kQ29sKSA9PT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHBpZWNlLm1ha2VLaW5nKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV4dENhcHR1cmVzID0gdGhpcy5jaGFpbkNhcHR1cmVzKGVuZFJvdywgZW5kQ29sKTtcclxuICAgICAgICAgICAgICAgIGlmIChuZXh0Q2FwdHVyZXMgJiYgY2FwdHVyZWRBbHJlYWR5ID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5leHRDYXB0dXJlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlVHVybigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hhbmdlVHVybigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvKipcclxuICAgICAqIEJyaW5nIHRoZSBib2FyZCBiYWNrIHRvIGl0J3MgaW5pdGlhbCBzdGF0ZSBiZWZvcmUgdGhlIHNpbXVsYXRlZCBtb3ZlXHJcbiAgICAgKiBAcGFyYW0gc3RhcnRSb3cgLSBTdGFydGluZyByb3cgb2YgdGhlIEFJJ3MgcGllY2VcclxuICAgICAqIEBwYXJhbSBzdGFydENvbCAtIFN0YXJ0aW5nIGNvbHVtbiBvZiB0aGUgQUkncyBwaWVjZVxyXG4gICAgICogQHBhcmFtIGZpbmFsUm93IC0gRmluYWwgcm93IG9mIHRoZSBBSSdzIHBpZWNlXHJcbiAgICAgKiBAcGFyYW0gZmluYWxDb2wgLSBGaW5hbCByb3cgb2YgdGhlIEFJJ3MgcGllY2VcclxuICAgICAqIEBwYXJhbSBjYXB0dXJlZFBpZWNlcyAtIEFycmF5IG9mIHBpZWNlcyBjYXB0dXJlZCBhbmQgdGhlaXIgcG9zaXRpb25cclxuICAgICAqIEBwYXJhbSB3YXNQcm9tb3RlZCAtIEJvb2xlYW4gdHJhY2tpbmcgd2hldGhlciB0aGUgbW92aW5nIHBpZWNlIHdhcyBwcm9tb3RlZCBcclxuICAgICAqL1xyXG4gICAgcHVibGljIHVuZG9TaW11bGF0aW9uKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sOiBudW1iZXIsIGZpbmFsUm93OiBudW1iZXIsIGZpbmFsQ29sOiBudW1iZXIsIFxyXG4gICAgICAgIGNhcHR1cmVkUGllY2VzOiB7cGllY2U6IENoZWNrZXJzUGllY2UsIHJvdzogbnVtYmVyLCBjb2w6IG51bWJlcn1bXSwgd2FzUHJvbW90ZWQ6IGJvb2xlYW4pOiB2b2lkIHtcclxuICAgICAgICAvLyBSZXZlcnNlIHRoZSBwb3NpdGlvbiBvZiB0aGUgcGllY2UgdG8gd2hhdCBpdCB3YXMgYmVmb3JlIHRoZSAnc2ltdWxhdGVkIG1vdmUnXHJcbiAgICAgICAgY29uc3QgcGllY2UgPSB0aGlzLmdldFBpZWNlKGZpbmFsUm93LCBmaW5hbENvbCk7XHJcbiAgICAgICAgdGhpcy5ib2FyZFtmaW5hbFJvd11bZmluYWxDb2xdID0gbnVsbDtcclxuICAgICAgICB0aGlzLmJvYXJkW3N0YXJ0Um93XVtzdGFydENvbF0gPSBwaWVjZTtcclxuXHJcbiAgICAgICAgY2FwdHVyZWRQaWVjZXMuZm9yRWFjaCgoY2FwdHVyZWRQaWVjZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmJvYXJkW2NhcHR1cmVkUGllY2Uucm93XVtjYXB0dXJlZFBpZWNlLmNvbF0gPSBjYXB0dXJlZFBpZWNlLnBpZWNlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyByZXZlcnNlIHRoZSBBSSdzIHBpZWNlIGlmIGl0IHdhcyBwcm9tb3RlZCB0byBLaW5nIHN0YXR1c1xyXG4gICAgICAgIGlmICh3YXNQcm9tb3RlZCAmJiBwaWVjZSkge1xyXG4gICAgICAgICAgICBwaWVjZS5pc0tpbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGVzIGFuZCByZXR1cm5zIGEgY29weSBvZiB0aGUgY3VycmVudCBnYW1lIGluc3RhbmNlXHJcbiAgICAgKiBAcmV0dXJucyB7Q2hlY2tlcnNHYW1lfSAtIGNvcHkgb2YgZ2FtZVxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZGVlcENvcHlHYW1lKCk6IENoZWNrZXJzR2FtZSB7XHJcbiAgICAgICAgY29uc3QgY29waWVkR2FtZSA9IG5ldyBDaGVja2Vyc0dhbWUodGhpcy5wbGF5ZXJzWzBdLmRlZXBDb3B5UGxheWVyKCksIHRoaXMucGxheWVyc1sxXS5kZWVwQ29weVBsYXllcigpLCB0aGlzLmZvcmNlZEp1bXBzKTtcclxuICAgIFxyXG4gICAgICAgIC8vIENvcHkgdGhlIGJvYXJkXHJcbiAgICAgICAgY29waWVkR2FtZS5ib2FyZCA9IHRoaXMuYm9hcmQubWFwKHJvdyA9PiBcclxuICAgICAgICAgICAgcm93Lm1hcChwaWVjZSA9PiBwaWVjZSA/IHBpZWNlLmRlZXBDb3B5UGllY2UoKSA6IG51bGwpXHJcbiAgICAgICAgKTtcclxuICAgIFxyXG4gICAgICAgIGNvcGllZEdhbWUuY3VycmVudFBsYXllciA9IHRoaXMuY3VycmVudFBsYXllcjtcclxuICAgICAgICBjb3BpZWRHYW1lLmN1cnJlbnRTdGF0ZSA9IHRoaXMuY3VycmVudFN0YXRlOyBcclxuICAgICAgICBjb3BpZWRHYW1lLndpbm5lciA9IHRoaXMud2lubmVyID8gdGhpcy53aW5uZXIuZGVlcENvcHlQbGF5ZXIoKSA6IG51bGw7XHJcbiAgICBcclxuICAgICAgICByZXR1cm4gY29waWVkR2FtZTtcclxuICAgIH1cclxufSIsImltcG9ydCB7TW92ZXMsIFBpZWNlQ29sb3IsIENoZWNrZXJzUGllY2UsIENoZWNrZXJzQm9hcmQsIFN0YXRlLCBQbGF5ZXIsIENoZWNrZXJzR2FtZX0gZnJvbSAnLi9jaGVja2Vyc0dhbWUnO1xyXG5cclxuLyoqXHJcbiAqIEEgY2xhc3MgZm9yIHRoZSBBSSBwbGF5ZXIgZXh0ZW5kaW5nIHRoZSByZWd1bGFyIHBsYXllciBjbGFzc1xyXG4gKiBIYXMgbWV0aG9kcyBmb3IgYSBoZXVyaXN0aWMgZXZhbHVhdGlvbiwgdGhlIG1pbmltYXggYWxnb3JpdGhtIGFuZCBhIG1ldGhvZCB0aGF0IG1ha2VzIHRoZSBtb3ZlXHJcbiAqIHJldHVybmVkIGJ5IG1pbmltYXhcclxuICovXHJcbmV4cG9ydCBjbGFzcyBDaGVja2Vyc0FJIGV4dGVuZHMgUGxheWVye1xyXG4gICAgcHJpdmF0ZSBnYW1lOiBDaGVja2Vyc0dhbWU7XHJcbiAgICBwcml2YXRlIGRlcHRoOiBudW1iZXI7XHJcbiAgICBwcml2YXRlIG9wZW5pbmdzOiBNYXA8c3RyaW5nLCBNb3Zlc1tdPjtcclxuICAgIHByaXZhdGUgY3VycmVudE9wZW5pbmc6IHN0cmluZyB8IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBjb2xvcjogUGllY2VDb2xvciwgZ2FtZTogQ2hlY2tlcnNHYW1lLCBkZXB0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgc3VwZXIobmFtZSwgY29sb3IpO1xyXG4gICAgICAgIHRoaXMuZ2FtZSA9IGdhbWU7XHJcbiAgICAgICAgdGhpcy5kZXB0aCA9IGRlcHRoO1xyXG4gICAgICAgIHRoaXMub3BlbmluZ3MgPSB0aGlzLm9wZW5pbmdTZXQoKTtcclxuICAgICAgICB0aGlzLmN1cnJlbnRPcGVuaW5nID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGN1bGF0ZXMgYSBzY29yZSBmb3IgdGhlIEFJIGJhc2VkIG9uIG51bWJlciBvZiByZWd1bGFyIGFuZCBraW5nIHBpZWNlcyBpdCBoYXMgb3Bwb3NlZCB0byB0aGUgdXNlclxyXG4gICAgICogQHBhcmFtIHtDaGVja2Vyc0dhbWV9IGdhbWUgLSBDdXJyZW50IHN0YXRlIG9mIHRoZSBnYW1lIFxyXG4gICAgICogQHJldHVybnMge251bWJlcn0gLSBUaGUgc2NvcmUgY2FsY3VsYXRlZFxyXG4gICAgICovXHJcblxyXG4gICAgcHVibGljIGhldXJpc3RpYyhnYW1lOiBDaGVja2Vyc0dhbWUpOiBudW1iZXIge1xyXG4gICAgICAgIGxldCBzY29yZSA9IDA7XHJcbiAgICAgICAgbGV0IGFpUGllY2VDb3VudCA9IGdhbWUucGxheWVyc1sxXS5udW1PZlBpZWNlcywgcGxheWVyUGllY2VDb3VudCA9IGdhbWUucGxheWVyc1swXS5udW1PZlBpZWNlcztcclxuICAgICAgICBsZXQgYWlLaW5nQ291bnQgPSAwLCBwbGF5ZXJLaW5nQ291bnQgPSAwO1xyXG5cclxuICAgICAgICAvLyBDb21wYXJlIG51bWJlciBvZiBwaWVjZXNcclxuICAgICAgICBzY29yZSArPSBhaVBpZWNlQ291bnQgKiAxNSAtIHBsYXllclBpZWNlQ291bnQgKiAxNTtcclxuXHJcbiAgICAgICAgLy8gU2luZ2xlIGNhcHR1cmVcclxuICAgICAgICBzY29yZSAtPSAgdGhpcy5jb3VudE9wcG9uZW50Q2FwdHVyZXNQb3NzaWJsZShQaWVjZUNvbG9yLlJlZCwgZ2FtZSk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IDg7IHJvdysrKSB7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IDg7IGNvbCsrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgcGllY2UgPSBnYW1lLmdldFBpZWNlKHJvdywgY29sKTtcclxuICAgICAgICAgICAgICAgIGlmIChwaWVjZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIENvbXBhcmUgS2luZyBDb3VudHNcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGllY2UuY29sb3IgPT09IFBpZWNlQ29sb3IuQmxhY2sgJiYgcGllY2UuaXNLaW5nID09PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFpS2luZ0NvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLlJlZCAmJiBwaWVjZS5pc0tpbmcgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGxheWVyS2luZ0NvdW50Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIENlbnRyYWwgYm94XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCA+PSAyICYmIGNvbCA8PSA1ICYmIHJvdyA+PSAzICYmIHJvdyA8PSA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlICs9IChwaWVjZS5jb2xvciA9PT0gUGllY2VDb2xvci5CbGFjayA/IDIuNSA6IC0yLjUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvLyBDZW50cmFsIGJvdW5kYXJpZXNcclxuICAgICAgICAgICAgICAgICAgICBpZiAocm93ID49IDMgJiYgcm93IDw9IDQgJiYgY29sIDwgMiAmJiBjb2wgPiA1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlICs9IChwaWVjZS5jb2xvciA9PT0gUGllY2VDb2xvci5CbGFjayA/IDAuNSA6IC0wLjUpXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEJhY2sgUm93IEd1YXJkXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWUubnVtT2ZUdXJucyA8IDEwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwaWVjZS5jb2xvciA9PT0gUGllY2VDb2xvci5CbGFjayAmJiByb3cgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2wgPT09IDEgfHwgY29sID09PSA1KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLlJlZCAmJiByb3cgPT09IDcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb2wgPT09IDIgfHwgY29sID09PSA2KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgLT0gMTA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEJhc2ljIFBpZWNlIFByb3RlY3Rpb25cclxuICAgICAgICAgICAgICAgICAgICBpZiAocm93ID49IDEgJiYgcm93IDw9IDYgJiYgY29sID49IDEgJiYgY29sIDw9IDYpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGJhY2t3YXJkUm93ID0gcGllY2UuY29sb3IgPT09IFBpZWNlQ29sb3IuQmxhY2sgPyByb3cgLSAxIDogcm93ICsgMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsZWZ0UHJvdGVjdGlvblBpZWNlID0gZ2FtZS5nZXRQaWVjZShiYWNrd2FyZFJvdywgY29sIC0gMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCByaWdodFByb3RlY3Rpb25QaWVjZSA9IGdhbWUuZ2V0UGllY2UoYmFja3dhcmRSb3csIGNvbCArIDEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxlZnRQcm90ZWN0aW9uUGllY2UgJiYgbGVmdFByb3RlY3Rpb25QaWVjZS5jb2xvciA9PT0gcGllY2UuY29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluY3JlYXNlIHNjb3JlIGJlY2F1c2UgdGhlIHBpZWNlIGlzIHByb3RlY3RlZCBmcm9tIHRoZSBsZWZ0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29yZSArPSAocGllY2UuY29sb3IgPT09IFBpZWNlQ29sb3IuQmxhY2sgPyA2IDogLTYpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyaWdodFByb3RlY3Rpb25QaWVjZSAmJiByaWdodFByb3RlY3Rpb25QaWVjZS5jb2xvciA9PT0gcGllY2UuY29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEluY3JlYXNlIHNjb3JlIGJlY2F1c2UgdGhlIHBpZWNlIGlzIHByb3RlY3RlZCBmcm9tIHRoZSByaWdodFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gKHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLkJsYWNrID8gNiA6IC02KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gUHlyYW1pZCBGb3JtYXRpb25cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZS5udW1PZlR1cm5zIDwgMTUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLkJsYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93ID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCA9PT0gMSB8fCBjb2wgPT09IDMgfHwgY29sID09IDUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gNTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93ID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCA9PT0gMiB8fCBjb2wgPT09IDQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gNTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocm93ID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbCA9PT0gMykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29yZSArPSA1O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSAgICBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFByb3RlY3QgdnVsbmVyYWJsZSBwaWVjZXNcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWdhbWUuaXNWdWxuZXJhYmxlKHJvdywgY29sKSkgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgKz0gKHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLkJsYWNrID8gLTY6IDYpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgc2NvcmUgKz0gYWlLaW5nQ291bnQgKiAyMCAtIHBsYXllcktpbmdDb3VudCAqIDIwO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBzY29yZTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcHJpdmF0ZSBjb3VudE9wcG9uZW50Q2FwdHVyZXNQb3NzaWJsZShjb2xvcjogUGllY2VDb2xvciwgZ2FtZTogQ2hlY2tlcnNHYW1lKTogbnVtYmVyIHtcclxuICAgICAgICBsZXQgY2FwdHVyZUNvdW50ID0gMDtcclxuICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCA4OyByb3crKykge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGllY2UgPSBnYW1lLmdldFBpZWNlKHJvdywgY29sKTtcclxuICAgICAgICAgICAgICAgIGlmIChwaWVjZSAmJiBwaWVjZS5jb2xvciA9PT0gY29sb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtb3ZlcyA9IGdhbWUucG9zc2libGVNb3Zlcyhyb3csIGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FwdHVyZUNvdW50ICs9IG1vdmVzLmZpbHRlcihtb3ZlID0+IE1hdGguYWJzKG1vdmUuc3RhcnRSb3cgLSBtb3ZlLmVuZFJvdykgPT09IDIpLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gY2FwdHVyZUNvdW50O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcGVuaW5nU2V0KCk6IE1hcDxzdHJpbmcsIE1vdmVzW10+IHtcclxuICAgICAgICBjb25zdCBvcGVuaW5ncyA9IG5ldyBNYXA8c3RyaW5nLCBNb3Zlc1tdPigpO1xyXG5cclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJPbGQgRm91cnRlZW50aFwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDcsIDAsIDYsIDEpIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJBbG1hXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCAyKSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAxLCA1LCAyKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgNSwgMywgNiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNywgMiwgNiwgMSkgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIkNlbnRyZVwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDQsIDMsIDMsIDQpIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJHbGFzZ293XCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCAyKSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAxLCA1LCAyKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgNSwgMywgNiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMSkgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIkxhaXJkIGFuZCBMYWR5XCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCAyKSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAxLCA1LCAyKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgNSwgMywgNiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNiwgNCwgNyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygzLCA2LCA0LCA1KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDQsIDMsIDYpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgNywgNCwgNSlcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJCbGFjayBEb2N0b3JcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDMsIDMsIDIpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDYsIDEsIDUsIDIpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA1LCAzLCA2KSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCA2LCA0LCA3KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDMsIDYsIDQsIDUpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNCwgMywgNiksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygzLCAyLCA1LCA0KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDYsIDMsIDQsIDUpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiTGFpcmQgYW5kIExhZHkgUmVmdXNlZFwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDYsIDQsIDcpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMSwgNiwgMiwgNSlcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJHbGFzZ293LVdoaWx0ZXJcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDMsIDMsIDIpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDYsIDEsIDUsIDIpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA1LCAzLCA2KSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCA2LCA0LCA1KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDEsIDYsIDIsIDUpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMSksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygxLCA0LCAyLCAzKVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIk5haWxvclwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDEsIDQsIDIsIDMpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJUaWxsaWNvdWx0cnlcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDMsIDMsIDIpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDYsIDEsIDUsIDIpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA1LCAzLCA0KSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiV2lsbCBvJyB0aGUgV2lzcFwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNiwgNCwgNyksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJEZWZpYW5jZVwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNiwgNCwgNSksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDEsIDIsIDIsIDMpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJGaWZlXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCAyKSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCA2LCA0LCA1KSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgNSwgMywgNiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgNywgNSwgNilcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJTb3V0ZXJcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDMsIDMsIDIpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDYsIDQsIDUpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA1LCAzLCA2KSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCA1LCA1LCA2KVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIldoaWx0ZXItSVwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNiwgNCwgNSksIC8vIHJlZCBvciBwbGF5ZXJzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLCAvLyBibGFjayBvciBhaSdzIG1vdmVcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDYsIDMsIDUsIDIpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiV2hpbHRlci1JSVwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMywgNSwgMilcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJXaGlsdGVyLUV4Y2hhbmdlXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCAyKSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAzLCA1LCAyKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDQpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiTWFpZCBvZiB0aGUgTWlsbFwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygzLCA2LCA0LCA3KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDQsIDMsIDMsIDQpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiRG91Z2xhc1wiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSwgLy8gcmVkIG9yIHBsYXllcnMgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgMiksIC8vIGJsYWNrIG9yIGFpJ3MgbW92ZVxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygzLCA2LCA0LCA3KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDcsIDAsIDYsIDEpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMSwgNiwgMiwgNSlcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJQaW9uZWVyXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLCAvLyByZWQgb3IgcGxheWVycyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCAyKSwgLy8gYmxhY2sgb3IgYWkncyBtb3ZlXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAxLCA1LCAyKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDEsIDYsIDIsIDUpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiV2hpdGUgRHlrZVwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNiwgMSwgNSwgMiksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygzLCA2LCA0ICw1KVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIldhZ3JhbVwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNiwgNCwgNyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAxLCAzLCAwKVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIkJvc3RvblwiLCBbXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg1LCAyLCA0LCAzKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDIsIDUsIDMsIDYpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgNiwgNCwgNyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygzLCA2LCA0LCA1KVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIkR5a2VcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA1LCAzLCA2KSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDQsIDMsIDMsIDIpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiQ3Jvc3NcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCA0KVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIldhdGVybG9vXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMywgMywgNCksXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAxLCA1LCAyKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDMsIDQsIDQsIDUpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiQXlyc2hpcmUgTGFzc2llXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMSwgMywgMCksXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg2LCAxLCA1LCAyKSxcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDEsIDAsIDIsIDEpXHJcbiAgICAgICAgXSk7XHJcbiAgICAgICAgb3BlbmluZ3Muc2V0KFwiU3dpdGNoZXJcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA3LCAzLCA2KVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIlNpbmdsZSBDb3JuZXJcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMyksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCA1LCAzLCA0KVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIlNlY29uZCBEb3VibGUgQ29ybmVyXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDMpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMSwgMywgMilcclxuICAgICAgICBdKTtcclxuICAgICAgICBvcGVuaW5ncy5zZXQoXCJCcmlzdG9sXCIsIFtcclxuICAgICAgICAgICAgbmV3IE1vdmVzKDUsIDIsIDQsIDEpLFxyXG4gICAgICAgICAgICBuZXcgTW92ZXMoMiwgMSwgMywgMCksXHJcbiAgICAgICAgICAgIG5ldyBNb3Zlcyg0LCAxLCAzLCAyKVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIlBhaXNsZXlcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMSksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAxLCAzLCAyKVxyXG4gICAgICAgIF0pO1xyXG4gICAgICAgIG9wZW5pbmdzLnNldChcIkJyaXN0b2wtQ3Jvc3NcIiwgW1xyXG4gICAgICAgICAgICBuZXcgTW92ZXMoNSwgMiwgNCwgMSksXHJcbiAgICAgICAgICAgIG5ldyBNb3ZlcygyLCAzLCAzLCA0KVxyXG4gICAgICAgIF0pO1xyXG4gICAgXHJcbiAgICAgICAgcmV0dXJuIG9wZW5pbmdzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBpZGVudGlmeU9wZW5pbmcoKTogdm9pZCB7XHJcbiAgICAgICAgbGV0IGZvdW5kT3BlbmluZyA9IGZhbHNlO1xyXG4gICAgICAgIGlmICh0aGlzLmdhbWUubnVtT2ZUdXJucyA8IE1hdGgubWF4KC4uLkFycmF5LmZyb20odGhpcy5vcGVuaW5ncy52YWx1ZXMoKSkubWFwKG8gPT4gby5sZW5ndGgpKSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IFtuYW1lLCBtb3Zlc10gb2YgdGhpcy5vcGVuaW5ncykge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuZ2FtZS5wbGF5ZXJPbmVNb3Zlcy5sZW5ndGggPD0gbW92ZXMubGVuZ3RoIC8gMikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcXVlbmNlTWF0Y2ggPSB0aGlzLmdhbWUucGxheWVyT25lTW92ZXMuZXZlcnkoKG1vdmUsIGluZGV4KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBtb3Zlc1tpbmRleCAqIDJdLmVxdWFscyhtb3ZlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZXF1ZW5jZU1hdGNoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudE9wZW5pbmcgPSBuYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3VuZE9wZW5pbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhazsgLy8gRXhpdCB0aGUgbG9vcCBvbmNlIGEgbWF0Y2hpbmcgc2VxdWVuY2UgaXMgZm91bmRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFmb3VuZE9wZW5pbmcpIHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50T3BlbmluZyA9IG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBcclxuICAgIC8qKlxyXG4gICAgICogTWluaW1heCBBbGdvcml0aG0gdXNlZCBpbiBDaGVja2VycyBnYW1lIHRvIGZpbmQgYmVzdCBtb3ZlLlxyXG4gICAgICogXHJcbiAgICAgKiBUaGlzIGlzIGEgcmVjdXJzaXZlIGZ1bmN0aW9uIHRoYXQgZXZhbHVhdGVzIHRoZSBzdGF0ZSBvZiB0aGUgZ2FtZSB0byBmaW5kIHRoZSBvcHRpbWFsIG1vdmUgZm9yIHRoZSBjdXJyZW50IHBsYXllcixcclxuICAgICAqIGxvb2tpbmcgYWhlYWQsIGF0IGEgY2VydGFpbiBzcGVjaWZpZWQgZGVwdGguIEl0IGFpbXMgdG8gbWF4aW1pemUgaXQncyBvd24gZ2FpbiBmcm9tIGEgbW92ZSBiZWluZyBtYWRlLCBhbmQgXHJcbiAgICAgKiBtaW5pbWl6ZSB0aGUgZ2FpbiBvZiB0aGUgdXNlci4gXHJcbiAgICAgKiBcclxuICAgICAqIEBwYXJhbSB7Q2hlY2tlcnNHYW1lfSBnYW1lIC0gQ3VycmVudCBzdGF0ZSBvZiB0aGUgQ2hlY2tlcnMgZ2FtZVxyXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGRlcHRoIC0gRGVwdGggdG8gd2hpY2ggZ2FtZSBpcyBldmFsdWF0ZWRcclxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNNYXhpbWl6aW5nUGxheWVyIC0gVGhlIHBsYXllciBtYXhpbWl6aW5nLCB0cnVlIGZvciBBSShCbGFjayBwbGF5ZXIpIGFuZCBmYWxzZSBmb3IgdGhlIHVzZXIoUmVkKVxyXG4gICAgICogQHJldHVybnMge1tudW1iZXIsIE1vdmVzIHwgbnVsbF19IFR1cGxlIHRoYXQgY29udGFpbnMgYmVzdCBldmFsdWF0aW9uIHNjb3JlIGFuZCBiZXN0IG1vdmVcclxuICAgICAqL1xyXG4gICAgcHVibGljIG1pbmltYXgoZ2FtZTogQ2hlY2tlcnNHYW1lLCBkZXB0aDogbnVtYmVyLCBhbHBoYTogbnVtYmVyLCBiZXRhOm51bWJlciwgbWF4aW1pemluZ1BsYXllcjogYm9vbGVhbik6IFtudW1iZXIsIE1vdmVzIHwgbnVsbF17XHJcblxyXG4gICAgICAgIGdhbWUuY2hlY2tFbmRPZkdhbWUoKTtcclxuXHJcbiAgICAgICAgaWYgKGRlcHRoID09IDAgfHwgZ2FtZS5jdXJyZW50U3RhdGUgPT09IFN0YXRlLmdhbWVGaW5pc2hlZCkge1xyXG4gICAgICAgICAgICBsZXQgc2NvcmUgPSB0aGlzLmhldXJpc3RpYyhnYW1lKTtcclxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coYEJhc2UgY2FzZSByZWFjaGVkLCBkZXB0aDogJHtkZXB0aH0sIHNjb3JlOiAke3Njb3JlfWApO1xyXG4gICAgICAgICAgICByZXR1cm4gW3Njb3JlLCBudWxsXTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgYmVzdFNjb3JlOiBudW1iZXIgPSBtYXhpbWl6aW5nUGxheWVyID8gLUluZmluaXR5IDogSW5maW5pdHk7XHJcbiAgICAgICAgbGV0IGJlc3RNb3ZlOiBNb3ZlcyB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgICAgICBpZiAobWF4aW1pemluZ1BsYXllcikge1xyXG4gICAgICAgICAgICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCA4OyByb3cgKyspIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGNvbCA9IDA7IGNvbCA8IDg7IGNvbCsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGllY2UgPSBnYW1lLmdldFBpZWNlKHJvdywgY29sKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGllY2UgJiYgcGllY2UuY29sb3IgPT09IFBpZWNlQ29sb3IuQmxhY2spIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW92ZXMgPSBnYW1lLnBvc3NpYmxlTW92ZXMocm93LCBjb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IG1vdmUgb2YgbW92ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBnYW1lQ29weSA9IGdhbWUuZGVlcENvcHlHYW1lKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVDb3B5Lm1vdmVBSShtb3ZlLnN0YXJ0Um93LCBtb3ZlLnN0YXJ0Q29sLCBtb3ZlLmVuZFJvdywgbW92ZS5lbmRDb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhgTWF4aW1pemluZyBjYWxsIC0gbW92ZTogKCR7bW92ZS5zdGFydFJvd30sICR7bW92ZS5zdGFydENvbH0pLCAoJHttb3ZlLmVuZFJvd30sICR7bW92ZS5lbmRDb2x9KSwgZGVwdGg6ICR7ZGVwdGh9YCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFtldmFsdWF0ZWRTY29yZV0gPSB0aGlzLm1pbmltYXgoZ2FtZUNvcHksIGRlcHRoIC0gMSwgYWxwaGEsIGJldGEsIGZhbHNlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxwaGEgPSBNYXRoLm1heChhbHBoYSwgZXZhbHVhdGVkU2NvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiZXRhIDw9IGFscGhhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlc3RNb3ZlID0gbW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVzdFNjb3JlID0gZXZhbHVhdGVkU2NvcmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2YWx1YXRlZFNjb3JlID4gYmVzdFNjb3JlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlc3RTY29yZSA9IGV2YWx1YXRlZFNjb3JlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0TW92ZSA9IG1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFtiZXN0U2NvcmUsIGJlc3RNb3ZlXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgcm93ID0gMDsgcm93IDwgODsgcm93ICsrKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCA4OyBjb2wrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBpZWNlID0gZ2FtZS5nZXRQaWVjZShyb3csIGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLlJlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBtb3ZlcyA9IGdhbWUucG9zc2libGVNb3Zlcyhyb3csIGNvbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbW92ZSBvZiBtb3Zlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZ2FtZUNvcHkgPSBnYW1lLmRlZXBDb3B5R2FtZSgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVDb3B5Lm1vdmVBSShtb3ZlLnN0YXJ0Um93LCBtb3ZlLnN0YXJ0Q29sLCBtb3ZlLmVuZFJvdywgbW92ZS5lbmRDb2wpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGBNaW5pbWl6aW5nIGNhbGwgLSBtb3ZlOiAoJHttb3ZlLnN0YXJ0Um93fSwgJHttb3ZlLnN0YXJ0Q29sfSksICgke21vdmUuZW5kUm93fSwgJHttb3ZlLmVuZENvbH0pLCBkZXB0aDogJHtkZXB0aH1gKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBbZXZhbHVhdGVkU2NvcmVdID0gdGhpcy5taW5pbWF4KGdhbWVDb3B5LCBkZXB0aCAtIDEsIGFscGhhLCBiZXRhLCB0cnVlKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXRhID0gTWF0aC5taW4oYmV0YSwgZXZhbHVhdGVkU2NvcmUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYmV0YSA8PSBhbHBoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlc3RNb3ZlID0gbW92ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0U2NvcmUgPSBldmFsdWF0ZWRTY29yZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZhbHVhdGVkU2NvcmUgPCBiZXN0U2NvcmUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0U2NvcmUgPSBldmFsdWF0ZWRTY29yZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBiZXN0TW92ZSA9IG1vdmU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIFtiZXN0U2NvcmUsIGJlc3RNb3ZlXTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBNZXRob2QgZm9yIHRoZSBBSSB0byBtYWtlIGEgbW92ZSB1c2luZyB0aGUgbWluaW1heCBhbGdvcml0aG0gdG8gZ2V0IHRoZSAnYmVzdCcgbW92ZSBhbmQgdXNpbmcgdGhhdC5cclxuICAgICAqL1xyXG4gICAgcHVibGljIG1ha2VNb3ZlKCk6IHZvaWQge1xyXG4gICAgICAgIGlmICh0aGlzLmdhbWUuY3VycmVudFN0YXRlID09PSBTdGF0ZS5nYW1lRmluaXNoZWQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJHYW1lIGlzIGZpbmlzaGVkLiBBSSBjYW5ub3QgbWFrZSBhIG1vdmUuXCIpO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUuY2hhbmdlVHVybigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5pZGVudGlmeU9wZW5pbmcoKTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudE9wZW5pbmcpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG1vdmUgPSB0aGlzLmdldE9wZW5pbmdNb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICBpZiAobW92ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2FtZS5tb3ZlUGllY2UobW92ZS5zdGFydFJvdywgbW92ZS5zdGFydENvbCwgbW92ZS5lbmRSb3csIG1vdmUuZW5kQ29sKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbGF5TWluaW1heE1vdmUoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gT3B0aW1hbCBPcGVuaW5nIEFsdGVybmF0aXZlXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5nYW1lLm51bU9mVHVybnMgPT09IDEgJiYgdGhpcy5nYW1lLmdldFBpZWNlKDMsIDQpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUubW92ZVBpZWNlKDIsIDUsIDMsIDQpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZ2FtZS5udW1PZlR1cm5zID09PSAzICYmIHRoaXMuZ2FtZS5nZXRQaWVjZSgyLCA1KSA9PT0gbnVsbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5nYW1lLm1vdmVQaWVjZSgxLCA2LCAyLCA1KTsgXHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5nYW1lLm51bU9mVHVybnMgPT09IDUgJiYgdGhpcy5nYW1lLmdldFBpZWNlKDEsIDYpID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmdhbWUubW92ZVBpZWNlKDAsIDcsIDEsIDYpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbGF5TWluaW1heE1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcGxheU1pbmltYXhNb3ZlKCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IFtzY29yZSwgbW92ZV0gPSB0aGlzLm1pbmltYXgodGhpcy5nYW1lLCB0aGlzLmRlcHRoLCAtSW5maW5pdHksIEluZmluaXR5LCB0cnVlKTtcclxuICAgICAgICBpZiAobW92ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUubW92ZVBpZWNlKG1vdmU/LnN0YXJ0Um93LCBtb3ZlPy5zdGFydENvbCwgbW92ZT8uZW5kUm93LCBtb3ZlPy5lbmRDb2wpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQUkgbW92ZWQgZnJvbTogKCR7bW92ZT8uc3RhcnRSb3d9LCAke21vdmU/LnN0YXJ0Q29sfSkgdG8gKCR7bW92ZT8uZW5kUm93fSwgJHttb3ZlPy5lbmRDb2x9KWApO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgRXZhbHVhdGVkIFNjb3JlIG9mIG1vdmU6ICR7c2NvcmV9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyggYCR7dGhpcy5nYW1lLnBsYXllcnNbMV0ubmFtZX0gaGFzIG5vIHZhbGlkIG1vdmVzIWApO1xyXG4gICAgICAgICAgICB0aGlzLmdhbWUuY2hhbmdlVHVybigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0T3BlbmluZ01vdmUoKTogTW92ZXMgfCBudWxsIHtcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50T3BlbmluZykge1xyXG4gICAgICAgICAgICBjb25zdCBzZXF1ZW5jZSA9IHRoaXMub3BlbmluZ3MuZ2V0KHRoaXMuY3VycmVudE9wZW5pbmcpO1xyXG4gICAgICAgICAgICBpZiAoc2VxdWVuY2UgJiYgdGhpcy5nYW1lLm51bU9mVHVybnMgPCBzZXF1ZW5jZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBzZXF1ZW5jZVt0aGlzLmdhbWUubnVtT2ZUdXJuc107XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQaWVjZUNvbG9yLCBTdGF0ZSwgUGxheWVyLCBDaGVja2Vyc0dhbWUgfSBmcm9tICcuLi9jb21wb25lbnRzL2NoZWNrZXJzR2FtZSc7XHJcbmltcG9ydCB7IENoZWNrZXJzQUkgfSBmcm9tICcuLi9jb21wb25lbnRzL2NoZWNrZXJzQUknO1xyXG5cclxuLy8gRE9NIE1hbmlwdWxhdGlvblxyXG5cclxuLyoqXHJcbiAqIEEgbWFwIHRvIGhvbGQgZXZlbnQgbGlzdGVuZXJzIGZvciBlYWNoIHBpZWNlIG9uIHRoZSBjaGVja2VycyBib2FyZC5cclxuICovXHJcbmNvbnN0IHBpZWNlRXZlbnRMaXN0ZW5lcnMgPSBuZXcgTWFwPEhUTUxEaXZFbGVtZW50LCBFdmVudExpc3RlbmVyPigpO1xyXG5sZXQgZ2FtZTogQ2hlY2tlcnNHYW1lO1xyXG5cclxuLy9Jbml0aWFsIFNjcmVlbiByZXBsYWNlIHdpdGggR2FtZSBCb2FyZFxyXG5cclxuY29uc3Qgc3RhcnRMb2NhbEdhbWVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5pdGlhbC1zY3JlZW4gLmluaXRpYWwtc2NyZWVuLWNvbnRhaW5lciAuY29udGFpbmVyIC5uYW1lLWVudHJ5ICNzdGFydEdhbWVCdXR0b24nKTtcclxuc3RhcnRMb2NhbEdhbWVCdG4/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc3RhcnRMb2NhbEdhbWUpO1xyXG5cclxuY29uc3Qgc3RhcnRBSUdhbWVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaW5pdGlhbC1zY3JlZW4gLmluaXRpYWwtc2NyZWVuLWNvbnRhaW5lciAuY29udGFpbmVyIC5uYW1lLWVudHJ5ICNzdGFydEFJR2FtZUJ1dHRvbicpO1xyXG5zdGFydEFJR2FtZUJ0bj8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzdGFydEFJR2FtZSk7XHJcblxyXG5sZXQgZW5mb3JjZWRKdW1wQ2hlY2s6IGJvb2xlYW47XHJcbmNvbnN0IGNoZWNrQm94ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmluaXRpYWwtc2NyZWVuIC5pbml0aWFsLXNjcmVlbi1jb250YWluZXIgLmNvbnRhaW5lciAubmFtZS1lbnRyeSAjZW5mb3JjZWRKdW1wcycpO1xyXG5jaGVja0JveD8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGV2ZW50OiBFdmVudCkgPT4ge1xyXG4gICAgY29uc3QgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBpZiAodGFyZ2V0LmNoZWNrZWQpIHtcclxuICAgICAgICBlbmZvcmNlZEp1bXBDaGVjayA9IHRydWU7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEp1bXBzOiAke2VuZm9yY2VkSnVtcENoZWNrfWApO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGVuZm9yY2VkSnVtcENoZWNrID0gZmFsc2U7XHJcbiAgICAgICAgY29uc29sZS5sb2coYEp1bXBzOiAke2VuZm9yY2VkSnVtcENoZWNrfWApO1xyXG4gICAgICB9XHJcbn0pO1xyXG5cclxuY29uc3QgcmVzdGFydExvY2FsR2FtZUJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXJ0TG9jYWxHYW1lQnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XHJcbmNvbnN0IHJlc3RhcnRBSUdhbWVCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGFydEFJR2FtZUJ1dHRvbicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xyXG5cclxuXHJcbi8vIEVuZCBvZiBHYW1lIGVsZW1lbnRzXHJcbmNvbnN0IGVuZE9mR2FtZVNlY3Rpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZW5kLW9mLWdhbWUtc2VjdGlvbicpIGFzIEhUTUxFbGVtZW50O1xyXG5jb25zdCB3aW5uZXJBbm5vdW5jZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2lubmVyQW5ub3VuY2VtZW50JykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbmNvbnN0IHBsYXllck9uZUZpbmFsTmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXJPbmVGaW5hbE5hbWUnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuY29uc3QgcGxheWVyT25lRmluYWxTY29yZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXJPbmVGaW5hbFNjb3JlJykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbmNvbnN0IHBsYXllck9uZUZpbmFsQ2FwdHVyZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyT25lRmluYWxDYXB0dXJlZCcpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5jb25zdCBwbGF5ZXJUd29GaW5hbE5hbWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyVHdvRmluYWxOYW1lJykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbmNvbnN0IHBsYXllclR3b0ZpbmFsU2NvcmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyVHdvRmluYWxTY29yZScpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5jb25zdCBwbGF5ZXJUd29GaW5hbENhcHR1cmVkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BsYXllclR3b0ZpbmFsQ2FwdHVyZWQnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuXHJcbi8vIFBsYXllciBPbmVcclxuY29uc3QgcGxheWVyT25lTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXItb25lIC5jb250YWluZXIgLm5hbWUnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuY29uc3QgcGxheWVyT25lU2NvcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyLW9uZSAuY29udGFpbmVyIC5zY29yZScpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5jb25zdCBwbGF5ZXJPbmVDYXB0dXJlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXItb25lIC5jb250YWluZXIgLmNhcHR1cmVkJykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbmNvbnN0IHBsYXllck9uZVR1cm4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyLW9uZSAuY29udGFpbmVyIC50dXJuJykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcblxyXG4vL1BsYXllciBUd29cclxuY29uc3QgcGxheWVyVHdvTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXItdHdvIC5jb250YWluZXIgLm5hbWUnKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuY29uc3QgcGxheWVyVHdvU2NvcmUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyLXR3byAuY29udGFpbmVyIC5zY29yZScpIGFzIEhUTUxEaXZFbGVtZW50O1xyXG5jb25zdCBwbGF5ZXJUd29DYXB0dXJlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wbGF5ZXItdHdvIC5jb250YWluZXIgLmNhcHR1cmVkJykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbmNvbnN0IHBsYXllclR3b1R1cm4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucGxheWVyLXR3byAuY29udGFpbmVyIC50dXJuJykgYXMgSFRNTERpdkVsZW1lbnQ7XHJcblxyXG5jb25zdCByb3dzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJvYXJkLWNvbnRhaW5lciAuY29udGFpbmVyIC5yb3cnKSE7XHJcblxyXG4vKipcclxuICogU3RhcnRzIHRoZSBMb2NhbCAyIHBsYXllciBnYW1lIG9uIHRoZSBET00sIGJ5IGhpZGluZyB0aGUgaW5pdGlhbCBzY3JlZW4gYW5kIHNob3dpbmcgdGhlIG1haW4gZ2FtZSBzY3JlZW5cclxuICovXHJcbmZ1bmN0aW9uIHN0YXJ0TG9jYWxHYW1lKCkge1xyXG4gICAgY29uc3QgcGxheWVyT25lTmFtZSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyT25lTmFtZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlIHx8ICdQbGF5ZXIgMSc7XHJcbiAgICBjb25zdCBwbGF5ZXJUd29OYW1lID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwbGF5ZXJUd29OYW1lJykgYXMgSFRNTElucHV0RWxlbWVudCkudmFsdWUgfHwgJ1BsYXllciAyJztcclxuXHJcbiAgICBjb25zdCBwbGF5ZXJPbmUgPSBuZXcgUGxheWVyKHBsYXllck9uZU5hbWUsIFBpZWNlQ29sb3IuUmVkKTtcclxuICAgIGNvbnN0IHBsYXllclR3byA9IG5ldyBQbGF5ZXIocGxheWVyVHdvTmFtZSwgUGllY2VDb2xvci5CbGFjayk7XHJcbiAgICBnYW1lID0gbmV3IENoZWNrZXJzR2FtZShwbGF5ZXJPbmUsIHBsYXllclR3bywgZW5mb3JjZWRKdW1wQ2hlY2spO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBVSSB3aXRoIHBsYXllciBuYW1lc1xyXG4gICAgdXBkYXRlU2NvcmVDYXJkKCk7XHJcblxyXG4gICAgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbml0aWFsLXNjcmVlbicpIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluJykgYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgIHBvcHVsYXRlQm9hcmQoKTtcclxufVxyXG5cclxuLy8gQUkgR0FNRVxyXG4vKipcclxuICogU3RhcnRzIHRoZSBnYW1lIGFnYWluc3QgdGhlIEFJIG9uIHRoZSBET00sIGJ5IGhpZGluZyB0aGUgaW5pdGlhbCBzY3JlZW4gYW5kIHNob3dpbmcgdGhlIG1haW4gZ2FtZSBzY3JlZW5cclxuICovXHJcbmZ1bmN0aW9uIHN0YXJ0QUlHYW1lKCkge1xyXG4gICAgY29uc3QgcGxheWVyT25lTmFtZSA9IChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGxheWVyT25lTmFtZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQpLnZhbHVlIHx8ICdQbGF5ZXIgMSc7XHJcbiAgICBjb25zdCBwbGF5ZXJUd29OYW1lID0gJ01pbmltYXgtQS9CJztcclxuXHJcbiAgICBjb25zdCBwbGF5ZXJPbmUgPSBuZXcgUGxheWVyKHBsYXllck9uZU5hbWUsIFBpZWNlQ29sb3IuUmVkKTtcclxuICAgIGNvbnN0IHBsYXllclR3byA9IG5ldyBQbGF5ZXIocGxheWVyVHdvTmFtZSwgUGllY2VDb2xvci5CbGFjayk7XHJcbiAgICBnYW1lID0gbmV3IENoZWNrZXJzR2FtZShwbGF5ZXJPbmUsIHBsYXllclR3bywgZW5mb3JjZWRKdW1wQ2hlY2spO1xyXG5cclxuICAgIC8vIENyZWF0ZSB0aGUgQUkgcGxheWVyIGFuZCBzZXQgaXQgYXMgcGxheWVyIHR3b1xyXG4gICAgY29uc3QgYWkgPSBuZXcgQ2hlY2tlcnNBSShwbGF5ZXJUd29OYW1lLCBQaWVjZUNvbG9yLkJsYWNrLCBnYW1lLCA1KTtcclxuICAgIGdhbWUuc2V0QUkoYWkpO1xyXG5cclxuICAgIC8vIFVwZGF0ZSBVSSB3aXRoIHBsYXllciBuYW1lc1xyXG4gICAgdXBkYXRlU2NvcmVDYXJkKCk7XHJcblxyXG4gICAgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5pbml0aWFsLXNjcmVlbicpIGFzIEhUTUxFbGVtZW50KS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluJykgYXMgSFRNTEVsZW1lbnQpLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG5cclxuICAgIHBvcHVsYXRlQm9hcmQoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlc3RhcnRzIHRoZSBHYW1lIHRvIGl0cyBzdGFydCBzdGF0ZVxyXG4gKi9cclxucmVzdGFydExvY2FsR2FtZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgIGVuZE9mR2FtZVNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdub25lJzsgXHJcbiAgICBjbGVhckhpZ2hsaWdodHMoKTtcclxuICAgIC8vIGl0ZXJhdGUgdGhyb3VnaCB0aGUgYm9hcmRcclxuICAgIHJvd3MuZm9yRWFjaCgocm93KSA9PiB7XHJcbiAgICAgICAgcm93LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb2wnKS5mb3JFYWNoKChjb2wpID0+IHtcclxuICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBleGlzdGluZyBwaWVjZXMgYW5kIGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgICAgICAgICBpZiAoY29sLmZpcnN0Q2hpbGQpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBpZWNlRGl2ID0gY29sLmZpcnN0Q2hpbGQgYXMgSFRNTERpdkVsZW1lbnQ7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ0xpc3RlbmVyID0gcGllY2VFdmVudExpc3RlbmVycy5nZXQocGllY2VEaXYpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBwaWVjZURpdi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGV4aXN0aW5nTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIHBpZWNlRXZlbnRMaXN0ZW5lcnMuZGVsZXRlKHBpZWNlRGl2KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbC5yZW1vdmVDaGlsZChjb2wuZmlyc3RDaGlsZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gICAgc3RhcnRMb2NhbEdhbWUoKTtcclxufSk7XHJcblxyXG4vKipcclxuICogUmVzdGFydHMgdGhlIEdhbWUgdG8gaXRzIHN0YXJ0IHN0YXRlXHJcbiAqL1xyXG5yZXN0YXJ0QUlHYW1lQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgZW5kT2ZHYW1lU2VjdGlvbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyBcclxuICAgIGNsZWFySGlnaGxpZ2h0cygpO1xyXG4gICAgLy8gaXRlcmF0ZSB0aHJvdWdoIHRoZSBib2FyZFxyXG4gICAgcm93cy5mb3JFYWNoKChyb3cpID0+IHtcclxuICAgICAgICByb3cucXVlcnlTZWxlY3RvckFsbCgnLmNvbCcpLmZvckVhY2goKGNvbCkgPT4ge1xyXG4gICAgICAgICAgICAvLyByZW1vdmUgYWxsIGV4aXN0aW5nIHBpZWNlcyBhbmQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICAgICAgICAgIGlmIChjb2wuZmlyc3RDaGlsZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGllY2VEaXYgPSBjb2wuZmlyc3RDaGlsZCBhcyBIVE1MRGl2RWxlbWVudDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTGlzdGVuZXIgPSBwaWVjZUV2ZW50TGlzdGVuZXJzLmdldChwaWVjZURpdik7XHJcbiAgICAgICAgICAgICAgICBpZiAoZXhpc3RpbmdMaXN0ZW5lcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHBpZWNlRGl2LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXhpc3RpbmdMaXN0ZW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgcGllY2VFdmVudExpc3RlbmVycy5kZWxldGUocGllY2VEaXYpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29sLnJlbW92ZUNoaWxkKGNvbC5maXJzdENoaWxkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBzdGFydEFJR2FtZSgpO1xyXG59KTtcclxuXHJcbi8qKlxyXG4gKiBQb3B1bGF0ZXMgdGhlIGdhbWUgYm9hcmQgb24gdGhlIERPTSwgc2hvd2luZyB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgZ2FtZS5cclxuICovXHJcbmZ1bmN0aW9uIHBvcHVsYXRlQm9hcmQoKSB7XHJcbiAgICB1cGRhdGVTY29yZUNhcmQoKTtcclxuICAgIHJvd3MuZm9yRWFjaCgocm93LCByb3dJbmRleCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNvbHMgPSByb3cucXVlcnlTZWxlY3RvckFsbCgnLmNvbCcpITtcclxuICAgICAgICBjb2xzLmZvckVhY2goKGNvbCwgY29sSW5kZXgpID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcGllY2UgPSBnYW1lLmdldFBpZWNlKHJvd0luZGV4LCBjb2xJbmRleCk7XHJcbiAgICAgICAgICAgIGlmIChwaWVjZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGllY2VEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICAgICAgICAgIGlmIChwaWVjZS5pc0tpbmcgPT09IHRydWUpIHtcclxuICAgICAgICAgICAgICAgICAgICBwaWVjZURpdi5jbGFzc0xpc3QuYWRkKHBpZWNlLmNvbG9yID09PSBQaWVjZUNvbG9yLkJsYWNrID8gJ2JsYWNrLXBpZWNlLWtpbmcnOiAncmVkLXBpZWNlLWtpbmcnKVxyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHBpZWNlRGl2LmNsYXNzTGlzdC5hZGQocGllY2UuY29sb3IgPT09IFBpZWNlQ29sb3IuQmxhY2sgPyAnYmxhY2stcGllY2UnIDogJ3JlZC1waWVjZScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29sLmFwcGVuZENoaWxkKHBpZWNlRGl2KTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBiaW5kIGZ1bmN0aW9uIHdpdGggY29ycmVjdCBwYXJhbWV0ZXJzXHJcbiAgICAgICAgICAgICAgICBwaWVjZURpdi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgc2VsZWN0UGllY2UuYmluZChudWxsLCByb3dJbmRleCwgY29sSW5kZXgsIHBpZWNlRGl2KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogQ2xlYXJzIGFueSBoaWdobGlnaHRlZCBjZWxscyBhbmQgcmVtb3ZlcyBldmVudCBsaXN0ZW5lcnMgZnJvbSB0aGVtLlxyXG4gKi9cclxuZnVuY3Rpb24gY2xlYXJIaWdobGlnaHRzKCkge1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmhpZ2hsaWdodCcpLmZvckVhY2goaGlnaGxpZ2h0ZWRFbGVtZW50ID0+IHtcclxuICAgICAgICBjb25zdCBoaWdobGlnaHRlZCA9IGhpZ2hsaWdodGVkRWxlbWVudCBhcyBIVE1MRGl2RWxlbWVudDtcclxuICAgICAgICBoaWdobGlnaHRlZC5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQnKTtcclxuXHJcbiAgICAgICAgY29uc3QgbW92ZUxpc3RlbmVyID0gcGllY2VFdmVudExpc3RlbmVycy5nZXQoaGlnaGxpZ2h0ZWQpO1xyXG4gICAgICAgIGlmIChtb3ZlTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgaGlnaGxpZ2h0ZWQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG1vdmVMaXN0ZW5lcik7XHJcbiAgICAgICAgICAgIHBpZWNlRXZlbnRMaXN0ZW5lcnMuZGVsZXRlKGhpZ2hsaWdodGVkKTtcclxuICAgICAgICB9IFxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVzIHRoZSBzZWxlY3Rpb24gb2YgcGllY2VzIG9uIHRoZSBET00sIGhpZ2hsaWdodHMgcG90ZW50aWFsIG1vdmUgbG9jYXRpb25zLCBcclxuICogYW5kIGFkZHMgbGlzdGVuZXJzIGZvciBtb3ZlIGV4ZWN1dGlvbiBpZiBwb3NzaWJsZS5cclxuICogQHBhcmFtIHtudW1iZXJ9IHJvd0luZGV4IC0gVGhlIHJvdyBpbmRleCBvZiB0aGUgc2VsZWN0ZWQgcGllY2UuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBjb2xJbmRleCAtIFRoZSBjb2x1bW4gaW5kZXggb2YgdGhlIHNlbGVjdGVkIHBpZWNlLlxyXG4gKiBAcGFyYW0ge0hUTUxEaXZFbGVtZW50fSBwaWVjZURpdiAtIFRoZSBkaXYgZWxlbWVudCBvZiB0aGUgc2VsZWN0ZWQgcGllY2UuXHJcbiAqL1xyXG5mdW5jdGlvbiBzZWxlY3RQaWVjZShyb3dJbmRleDogbnVtYmVyLCBjb2xJbmRleDogbnVtYmVyLCBwaWVjZURpdjogSFRNTERpdkVsZW1lbnQpIHtcclxuICAgIGNvbnN0IHBpZWNlID0gZ2FtZS5nZXRQaWVjZShyb3dJbmRleCwgY29sSW5kZXgpO1xyXG4gICAgY2xlYXJIaWdobGlnaHRzKCk7IFxyXG4gICAgICAgICAgICBcclxuICAgIC8vIHJlbW92ZSBwcmV2aW91c2x5IHNlbGVjdGVkIHBpZWNlc1xyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJsYWNrLXBpZWNlLCAucmVkLXBpZWNlJykuZm9yRWFjaChwID0+IHtcclxuICAgICAgICBwLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7XHJcbiAgICB9KTtcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5ibGFjay1waWVjZS1raW5nLCAucmVkLXBpZWNlLWtpbmcnKS5mb3JFYWNoKHAgPT4ge1xyXG4gICAgICAgIHAuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyBjaGVjayBwbGF5ZXIncyB0dXJuIGFuZCBpZiBwaWVjZSBleGlzdHNcclxuICAgIGlmIChwaWVjZSAmJiBwaWVjZS5jb2xvciA9PT0gZ2FtZS5jdXJyZW50UGxheWVyLmNvbG9yKSB7XHJcbiAgICAgICAgcGllY2VEaXYuY2xhc3NMaXN0LnRvZ2dsZSgnc2VsZWN0ZWQnKTtcclxuICAgICAgICBjb25zdCBtb3ZlcyA9IGdhbWUucG9zc2libGVNb3Zlcyhyb3dJbmRleCwgY29sSW5kZXgpO1xyXG5cclxuICAgICAgICAvLyBjaGVjayBpZiBhbnkgbW92ZXMgYXZhaWxhYmxlXHJcbiAgICAgICAgaWYgKG1vdmVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgLy8gaGlnaGxpZ2h0IHBvdGVudGlhbCBtb3ZlIGxvY2F0aW9uc1xyXG4gICAgICAgICAgICBtb3Zlcy5mb3JFYWNoKG1vdmUgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0Q2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC5jb2xbZGF0YS1yb3c9JyR7bW92ZS5lbmRSb3d9J11bZGF0YS1jb2w9JyR7bW92ZS5lbmRDb2x9J11gKSBhcyBIVE1MRGl2RWxlbWVudDtcclxuICAgICAgICAgICAgICAgIGlmICh0YXJnZXRDZWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2VsbC5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIGFueSBleGlzdGluZyBsaXN0ZW5lcnNcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBleGlzdGluZ0xpc3RlbmVyID0gcGllY2VFdmVudExpc3RlbmVycy5nZXQodGFyZ2V0Q2VsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4aXN0aW5nTGlzdGVuZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2VsbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIGV4aXN0aW5nTGlzdGVuZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG5ldyBldmVudCBsaXN0ZW5lciB0byBtb3ZlIGV4ZWN1dGlvblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vdmVMaXN0ZW5lciA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXhlY3V0ZU1vdmUocm93SW5kZXgsIGNvbEluZGV4LCBtb3ZlLmVuZFJvdywgbW92ZS5lbmRDb2wpO1xyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0Q2VsbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG1vdmVMaXN0ZW5lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgcGllY2VFdmVudExpc3RlbmVycy5zZXQodGFyZ2V0Q2VsbCwgbW92ZUxpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSBcclxufVxyXG5cclxuLyoqXHJcbiAqIEV4ZWN1dGVzIGEgbW92ZSBvbiB0aGUgRE9NIGJhc2VkIG9uIHRoZSBzZWxlY3RlZCBwaWVjZSBhbmQgaXRzIGRlc3RpbmF0aW9uLlxyXG4gKiBBbHNvIGhhbmRsZXMgQUkgbW92ZXMgb24gdGhlIERPTVxyXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnRSb3cgLSBUaGUgc3RhcnRpbmcgcm93IG9mIHRoZSBtb3ZlLlxyXG4gKiBAcGFyYW0ge251bWJlcn0gc3RhcnRDb2wgLSBUaGUgc3RhcnRpbmcgY29sdW1uIG9mIHRoZSBtb3ZlLlxyXG4gKiBAcGFyYW0ge251bWJlcn0gZW5kUm93IC0gVGhlIGVuZGluZyByb3cgb2YgdGhlIG1vdmUuXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBlbmRDb2wgLSBUaGUgZW5kaW5nIGNvbHVtbiBvZiB0aGUgbW92ZS5cclxuICovXHJcbmZ1bmN0aW9uIGV4ZWN1dGVNb3ZlKHN0YXJ0Um93OiBudW1iZXIsIHN0YXJ0Q29sOiBudW1iZXIsIGVuZFJvdzogbnVtYmVyLCBlbmRDb2w6IG51bWJlcikge1xyXG4gICAgY29uc3QgcGllY2UgPSBnYW1lLmdldFBpZWNlKHN0YXJ0Um93LCBzdGFydENvbCk7XHJcblxyXG4gICAgaWYgKHBpZWNlICYmIHBpZWNlLmNvbG9yID09PSBnYW1lLmN1cnJlbnRQbGF5ZXIuY29sb3IpIHtcclxuICAgICAgICAvLyBNb3ZlIHRoZSBwaWVjZSBhbmQgdXBkYXRlIHRoZSBET01cclxuICAgICAgICBnYW1lLm1vdmVQaWVjZShzdGFydFJvdywgc3RhcnRDb2wsIGVuZFJvdywgZW5kQ29sKTtcclxuICAgICAgICB1cGRhdGVCb2FyZERPTSgpO1xyXG5cclxuICAgICAgICAvLyBFbnN1cmUgY3VycmVudFBsYXllciBpcyBBSSBiZWZvcmUgY2FsbGluZyBtYWtlTW92ZVxyXG4gICAgICAgIGlmIChnYW1lLnBsYXllcnNbMV0gaW5zdGFuY2VvZiBDaGVja2Vyc0FJKSB7XHJcbiAgICAgICAgICAgIHdoaWxlIChnYW1lLmN1cnJlbnRQbGF5ZXIgPT09IGdhbWUucGxheWVyc1sxXSkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGdhbWUucGxheWVyc1sxXS5tYWtlTW92ZSgpO1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlQm9hcmRET00oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIHN0YXJ0IHBvc2l0aW9uIGlzIG5vdyBlbXB0eSBhbmQgdGhlIGVuZCBwb3NpdGlvbiBoYXMgYSBwaWVjZSwgbWF5YmUgcmVtb3ZlIHRoaXMgbm93XHJcbiAgICAgICAgY29uc3QgcGllY2VBdEVuZCA9IGdhbWUuZ2V0UGllY2UoZW5kUm93LCBlbmRDb2wpO1xyXG4gICAgICAgIGNvbnN0IHBpZWNlQXRTdGFydCA9IGdhbWUuZ2V0UGllY2Uoc3RhcnRSb3csIHN0YXJ0Q29sKTtcclxuICAgICAgICBpZiAoIXBpZWNlQXRTdGFydCAmJiBwaWVjZUF0RW5kKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAke3BpZWNlLmNvbG9yfSBwaWVjZSBoYXMgbW92ZWQgZnJvbSAoJHtzdGFydFJvd30sICR7c3RhcnRDb2x9KSB0byAoJHtlbmRSb3d9LCAke2VuZENvbH0pYCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vKipcclxuICogVXBkYXRlcyB0aGUgc2NvcmUgY2FyZCBvZiBlYWNoIHBsYXllciBhbmQgZGVjbGFyZXMgdGhlIHdpbm5lciBpZiB0aGUgZ2FtZSBoYXMgZW5kZWQuXHJcbiAqL1xyXG5mdW5jdGlvbiB1cGRhdGVTY29yZUNhcmQoKSB7XHJcbiAgICBwbGF5ZXJPbmVOYW1lLnRleHRDb250ZW50ID0gYCR7Z2FtZS5wbGF5ZXJzWzBdLm5hbWV9YDtcclxuICAgIHBsYXllck9uZVNjb3JlLnRleHRDb250ZW50ID0gYFNjb3JlOiAke2dhbWUucGxheWVyc1swXS5zY29yZX1gO1xyXG4gICAgcGxheWVyT25lQ2FwdHVyZWQudGV4dENvbnRlbnQgPSBgQ2FwdHVyZWQgUGllY2VzOiAke2dhbWUucGxheWVyc1swXS5jYXB0dXJlZFBpZWNlc31gO1xyXG5cclxuICAgIHBsYXllclR3b05hbWUudGV4dENvbnRlbnQgPSBgJHtnYW1lLnBsYXllcnNbMV0ubmFtZX1gO1xyXG4gICAgcGxheWVyVHdvU2NvcmUudGV4dENvbnRlbnQgPSBgU2NvcmU6ICR7Z2FtZS5wbGF5ZXJzWzFdLnNjb3JlfWA7XHJcbiAgICBwbGF5ZXJUd29DYXB0dXJlZC50ZXh0Q29udGVudCA9IGBDYXB0dXJlZCBQaWVjZXM6ICR7Z2FtZS5wbGF5ZXJzWzFdLmNhcHR1cmVkUGllY2VzfWA7XHJcblxyXG4gICAgaWYgKGdhbWUuY3VycmVudFBsYXllciA9PT0gZ2FtZS5wbGF5ZXJzWzBdKSB7XHJcbiAgICAgICAgcGxheWVyT25lVHVybi50ZXh0Q29udGVudCA9IGBUdXJuOiBZZXNgO1xyXG4gICAgICAgIHBsYXllclR3b1R1cm4udGV4dENvbnRlbnQgPSBgVHVybjogTm9gO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgICBwbGF5ZXJPbmVUdXJuLnRleHRDb250ZW50ID0gYFR1cm46IE5vYDtcclxuICAgICAgICBwbGF5ZXJUd29UdXJuLnRleHRDb250ZW50ID0gYFR1cm46IFllc2A7XHJcbiAgICB9XHJcblxyXG4gICAgZ2FtZS5jaGVja0VuZE9mR2FtZSgpO1xyXG5cclxuICAgIGlmIChnYW1lLmN1cnJlbnRTdGF0ZSA9PT0gU3RhdGUuZ2FtZUZpbmlzaGVkKSB7XHJcbiAgICAgICAgaWYgKGdhbWUud2lubmVyID09PSBnYW1lLnBsYXllcnNbMF0pIHtcclxuICAgICAgICAgICAgcGxheWVyT25lTmFtZS50ZXh0Q29udGVudCA9IGAke2dhbWUucGxheWVyc1swXS5uYW1lfSBoYXMgd29uIHRoZSBnYW1lIWA7XHJcbiAgICAgICAgICAgIHBsYXllclR3b05hbWUudGV4dENvbnRlbnQgPSBgJHtnYW1lLnBsYXllcnNbMV0ubmFtZX0sIHlvdSBsb3N0LCBob21pZSFgO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChnYW1lLndpbm5lciA9PT0gZ2FtZS5wbGF5ZXJzWzFdKSB7XHJcbiAgICAgICAgICAgIHBsYXllck9uZU5hbWUudGV4dENvbnRlbnQgPSBgJHtnYW1lLnBsYXllcnNbMF0ubmFtZX0sIHlvdSBsb3N0LCBob21pZSFgO1xyXG4gICAgICAgICAgICBwbGF5ZXJUd29OYW1lLnRleHRDb250ZW50ID0gYCR7Z2FtZS5wbGF5ZXJzWzFdLm5hbWV9IGhhcyB3b24gdGhlIGdhbWUhYDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHBsYXllck9uZU5hbWUudGV4dENvbnRlbnQgPSAnR2FtZSBpcyBhIGRyYXchJztcclxuICAgICAgICAgICAgcGxheWVyVHdvTmFtZS50ZXh0Q29udGVudCA9ICdHYW1lIGlzIGEgZHJhdyEnO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgcGxheWVyT25lVHVybi50ZXh0Q29udGVudCA9IGBgO1xyXG4gICAgICAgICAgICBwbGF5ZXJUd29UdXJuLnRleHRDb250ZW50ID0gYGA7XHJcbiAgICAgICAgICAgIGVuZE9mR2FtZVNlY3Rpb24uc3R5bGUuZGlzcGxheSA9ICdmbGV4JztcclxuXHJcbiAgICAgICAgICAgIHdpbm5lckFubm91bmNlbWVudC50ZXh0Q29udGVudCA9IGdhbWUud2lubmVyID8gYFdpbm5lcjogJHtnYW1lLndpbm5lci5uYW1lfWAgOiBcIkl0J3MgYSBkcmF3IVwiO1xyXG4gICAgXHJcbiAgICAgICAgICAgIHBsYXllck9uZUZpbmFsTmFtZS50ZXh0Q29udGVudCA9IGdhbWUucGxheWVyc1swXS5uYW1lO1xyXG4gICAgICAgICAgICBwbGF5ZXJPbmVGaW5hbFNjb3JlLnRleHRDb250ZW50ID0gYFNjb3JlOiAke2dhbWUucGxheWVyc1swXS5zY29yZX1gO1xyXG4gICAgICAgICAgICBwbGF5ZXJPbmVGaW5hbENhcHR1cmVkLnRleHRDb250ZW50ID0gYENhcHR1cmVkIFBpZWNlczogJHtnYW1lLnBsYXllcnNbMF0uY2FwdHVyZWRQaWVjZXN9YDtcclxuICAgIFxyXG4gICAgICAgICAgICBwbGF5ZXJUd29GaW5hbE5hbWUudGV4dENvbnRlbnQgPSBnYW1lLnBsYXllcnNbMV0ubmFtZTtcclxuICAgICAgICAgICAgcGxheWVyVHdvRmluYWxTY29yZS50ZXh0Q29udGVudCA9IGBTY29yZTogJHtnYW1lLnBsYXllcnNbMV0uc2NvcmV9YDtcclxuICAgICAgICAgICAgcGxheWVyVHdvRmluYWxDYXB0dXJlZC50ZXh0Q29udGVudCA9IGBDYXB0dXJlZCBQaWVjZXM6ICR7Z2FtZS5wbGF5ZXJzWzFdLmNhcHR1cmVkUGllY2VzfWA7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGVzIHRoZSBib2FyZCBvbiB0aGUgRE9NIGFmdGVyIGVhY2ggbW92ZSwgY2xlYXJpbmcgb2xkIHBpZWNlcyBhbmQgZXZlbnQgbGlzdGVuZXJzLCBcclxuICogYW5kIHJlcG9wdWxhdGluZyB3aXRoIGN1cnJlbnQgZ2FtZSBzdGF0ZS5cclxuICovXHJcbmZ1bmN0aW9uIHVwZGF0ZUJvYXJkRE9NKCkge1xyXG4gICAgY2xlYXJIaWdobGlnaHRzKCk7XHJcbiAgICAvLyBpdGVyYXRlIHRocm91Z2ggdGhlIGJvYXJkXHJcbiAgICByb3dzLmZvckVhY2goKHJvdykgPT4ge1xyXG4gICAgICAgIHJvdy5xdWVyeVNlbGVjdG9yQWxsKCcuY29sJykuZm9yRWFjaCgoY29sKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgZXhpc3RpbmcgcGllY2VzIGFuZCBldmVudCBsaXN0ZW5lcnNcclxuICAgICAgICAgICAgaWYgKGNvbC5maXJzdENoaWxkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwaWVjZURpdiA9IGNvbC5maXJzdENoaWxkIGFzIEhUTUxEaXZFbGVtZW50O1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdMaXN0ZW5lciA9IHBpZWNlRXZlbnRMaXN0ZW5lcnMuZ2V0KHBpZWNlRGl2KTtcclxuICAgICAgICAgICAgICAgIGlmIChleGlzdGluZ0xpc3RlbmVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcGllY2VEaXYucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCBleGlzdGluZ0xpc3RlbmVyKTtcclxuICAgICAgICAgICAgICAgICAgICBwaWVjZUV2ZW50TGlzdGVuZXJzLmRlbGV0ZShwaWVjZURpdik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb2wucmVtb3ZlQ2hpbGQoY29sLmZpcnN0Q2hpbGQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICAgIC8vIHBvcHVsYXRlIHRoZSBib2FyZCB3aXRoIHRoZSBwaWVjZXMgYXMgd2VsbCBhcyB0aGVpciBldmVudCBsaXN0ZW5lcnNcclxuICAgIHBvcHVsYXRlQm9hcmQoKTtcclxufVxyXG4iXSwibmFtZXMiOlsiU3RhdGUiLCJQaWVjZUNvbG9yIiwiUGxheWVyIiwiY29uc3RydWN0b3IiLCJuYW1lIiwiY29sb3IiLCJ0aGlzIiwic2NvcmUiLCJjYXB0dXJlZFBpZWNlcyIsIm51bU9mUGllY2VzIiwibnVtT2ZLaW5ncyIsImNhcHR1cmVzQXZhaWxhYmxlIiwidXBkYXRlQ2FwdHVyZWRQaWVjZXMiLCJjb3VudCIsInVwZGF0ZVNjb3JlIiwiZGVlcENvcHlQbGF5ZXIiLCJjb3BpZWRQbGF5ZXIiLCJDaGVja2Vyc1BpZWNlIiwiaXNLaW5nIiwiY2FwdHVyZVN0YXR1cyIsIm1ha2VLaW5nIiwiY2FwdHVyZUNoZWNrIiwiZGVlcENvcHlQaWVjZSIsIk1vdmVzIiwic3RhcnRSb3ciLCJzdGFydENvbCIsImVuZFJvdyIsImVuZENvbCIsImVxdWFscyIsImNoZWNrTW92ZSIsIkNoZWNrZXJzQm9hcmQiLCJib2FyZCIsImluaXRpYWxpemVCb2FyZCIsInJvdyIsImNvbCIsIkJsYWNrIiwiUmVkIiwiZ2V0UGllY2UiLCJDaGVja2Vyc0dhbWUiLCJwbGF5ZXJPbmUiLCJwbGF5ZXJUd28iLCJmb3JjZWRKdW1wcyIsInBsYXllcnMiLCJjdXJyZW50U3RhdGUiLCJpblByb2dyZXNzIiwiY3VycmVudFBsYXllciIsIndpbm5lciIsIm51bU9mVHVybnMiLCJwbGF5ZXJPbmVNb3ZlcyIsInBsYXllclR3b01vdmVzIiwiY2hhaW5pbmdSb3ciLCJjaGFpbmluZ0NvbCIsImNoYW5nZVR1cm4iLCJjYXB0dXJlc1Bvc3NpYmxlIiwidmFsaWRhdGVNb3ZlIiwiZGVzdGluYXRpb25TcXVhcmUiLCJwaWVjZSIsInZhbGlkYXRlQmxhY2siLCJ2YWxpZGF0ZVJlZCIsIk1hdGgiLCJhYnMiLCJjYW5DYXB0dXJlIiwicG9zc2libGVNb3ZlcyIsIm1vdmVzIiwiZGlyZWN0aW9uIiwicG90ZW50aWFsTW92ZXNBcnIiLCJtb3ZlIiwicHVzaCIsImZpbHRlciIsIm1pZGRsZVJvdyIsIm1pZGRsZUNvbCIsIm1pZGRsZVBpZWNlIiwiY3VycmVudFBpZWNlIiwibW92ZVBpZWNlIiwiY2FwdHVyZWRBbHJlYWR5IiwiZmxvb3IiLCJlbmVteVBpZWNlIiwiaGFuZGxlUGllY2VDYXB0dXJlIiwicHJvbW90ZVRvS2luZyIsIm5leHRDYXB0dXJlcyIsImNoYWluQ2FwdHVyZXMiLCJsZW5ndGgiLCJjb25zb2xlIiwibG9nIiwibWFwIiwiZmxhZyIsInNvbWUiLCJpc1Z1bG5lcmFibGUiLCJkaXJlY3Rpb25zIiwiZHIiLCJkYyIsIm9wcG9uZW50Um93Iiwib3Bwb25lbnRDb2wiLCJsYW5kaW5nUm93IiwibGFuZGluZ0NvbCIsImlzVmFsaWRQb3NpdGlvbiIsIm9wcG9uZW50UGllY2UiLCJsYW5kaW5nU3BvdCIsIm5vUGllY2VzTGVmdCIsInBsYXllciIsIm5vVmFsaWRNb3ZlcyIsInZhbGlkTW92ZXMiLCJjaGVja0VuZE9mR2FtZSIsImdhbWVGaW5pc2hlZCIsInNldEFJIiwiYWlQbGF5ZXIiLCJzaW11bGF0ZU1vdmUiLCJ3YXNQcm9tb3RlZCIsImN1cnJlbnRSb3ciLCJjdXJyZW50Q29sIiwibW92ZVJvdyIsIm1vdmVDb2wiLCJjYW5Db250aW51ZUNhcHR1cmUiLCJjYXB0dXJlZFBpZWNlIiwibW92ZUFJIiwidW5kb1NpbXVsYXRpb24iLCJmaW5hbFJvdyIsImZpbmFsQ29sIiwiZm9yRWFjaCIsImRlZXBDb3B5R2FtZSIsImNvcGllZEdhbWUiLCJDaGVja2Vyc0FJIiwiZ2FtZSIsImRlcHRoIiwic3VwZXIiLCJvcGVuaW5ncyIsIm9wZW5pbmdTZXQiLCJjdXJyZW50T3BlbmluZyIsImhldXJpc3RpYyIsImFpS2luZ0NvdW50IiwicGxheWVyS2luZ0NvdW50IiwiY291bnRPcHBvbmVudENhcHR1cmVzUG9zc2libGUiLCJiYWNrd2FyZFJvdyIsImxlZnRQcm90ZWN0aW9uUGllY2UiLCJyaWdodFByb3RlY3Rpb25QaWVjZSIsImNhcHR1cmVDb3VudCIsIk1hcCIsInNldCIsImlkZW50aWZ5T3BlbmluZyIsImZvdW5kT3BlbmluZyIsIm1heCIsIkFycmF5IiwiZnJvbSIsInZhbHVlcyIsIm8iLCJldmVyeSIsImluZGV4IiwibWluaW1heCIsImFscGhhIiwiYmV0YSIsIm1heGltaXppbmdQbGF5ZXIiLCJiZXN0U2NvcmUiLCJJbmZpbml0eSIsImJlc3RNb3ZlIiwiZ2FtZUNvcHkiLCJldmFsdWF0ZWRTY29yZSIsIm1pbiIsIm1ha2VNb3ZlIiwiZ2V0T3BlbmluZ01vdmUiLCJwbGF5TWluaW1heE1vdmUiLCJzZXF1ZW5jZSIsImdldCIsInBpZWNlRXZlbnRMaXN0ZW5lcnMiLCJzdGFydExvY2FsR2FtZUJ0biIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImFkZEV2ZW50TGlzdGVuZXIiLCJzdGFydExvY2FsR2FtZSIsInN0YXJ0QUlHYW1lQnRuIiwiZW5mb3JjZWRKdW1wQ2hlY2siLCJzdGFydEFJR2FtZSIsImNoZWNrQm94IiwiZXZlbnQiLCJ0YXJnZXQiLCJjaGVja2VkIiwicmVzdGFydExvY2FsR2FtZUJ1dHRvbiIsImdldEVsZW1lbnRCeUlkIiwicmVzdGFydEFJR2FtZUJ1dHRvbiIsImVuZE9mR2FtZVNlY3Rpb24iLCJ3aW5uZXJBbm5vdW5jZW1lbnQiLCJwbGF5ZXJPbmVGaW5hbE5hbWUiLCJwbGF5ZXJPbmVGaW5hbFNjb3JlIiwicGxheWVyT25lRmluYWxDYXB0dXJlZCIsInBsYXllclR3b0ZpbmFsTmFtZSIsInBsYXllclR3b0ZpbmFsU2NvcmUiLCJwbGF5ZXJUd29GaW5hbENhcHR1cmVkIiwicGxheWVyT25lTmFtZSIsInBsYXllck9uZVNjb3JlIiwicGxheWVyT25lQ2FwdHVyZWQiLCJwbGF5ZXJPbmVUdXJuIiwicGxheWVyVHdvTmFtZSIsInBsYXllclR3b1Njb3JlIiwicGxheWVyVHdvQ2FwdHVyZWQiLCJwbGF5ZXJUd29UdXJuIiwicm93cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ2YWx1ZSIsInVwZGF0ZVNjb3JlQ2FyZCIsInN0eWxlIiwiZGlzcGxheSIsInBvcHVsYXRlQm9hcmQiLCJhaSIsInJvd0luZGV4IiwiY29sSW5kZXgiLCJwaWVjZURpdiIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJhcHBlbmRDaGlsZCIsInNlbGVjdFBpZWNlIiwiYmluZCIsImNsZWFySGlnaGxpZ2h0cyIsImhpZ2hsaWdodGVkRWxlbWVudCIsImhpZ2hsaWdodGVkIiwicmVtb3ZlIiwibW92ZUxpc3RlbmVyIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImRlbGV0ZSIsInAiLCJ0b2dnbGUiLCJ0YXJnZXRDZWxsIiwiZXhpc3RpbmdMaXN0ZW5lciIsInVwZGF0ZUJvYXJkRE9NIiwicGllY2VBdEVuZCIsImV4ZWN1dGVNb3ZlIiwidGV4dENvbnRlbnQiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiXSwic291cmNlUm9vdCI6IiJ9